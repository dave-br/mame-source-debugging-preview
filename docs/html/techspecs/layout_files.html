<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MAME Layout Files &mdash; MAME Documentation 0.279 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=1a7c6e39"></script>
        <script src="../_static/doctools.js?v=9bcbadda"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MAME Layout Scripting" href="layout_script.html" />
    <link rel="prev" title="MAME Naming Conventions" href="naming.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MAME Documentation
          </a>
              <div class="version">
                0.279
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../whatis.html">What is MAME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../healthwarning.html">Health Warnings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../initialsetup/index.html">Getting MAME prepared</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usingmame/index.html">Basic MAME Usage and Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commandline/index.html">MAME Command-line Usage and OS-Specific Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/index.html">Advanced configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debugger/index.html">MAME Debugger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../luascript/index.html">Lua Scripting Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">MAME External Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing to MAME</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Technical Specifications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="naming.html">MAME Naming Conventions</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">MAME Layout Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="layout_script.html">MAME Layout Scripting</a></li>
<li class="toctree-l2"><a class="reference internal" href="object_finders.html">Object Finders</a></li>
<li class="toctree-l2"><a class="reference internal" href="inputsystem.html">Input System</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_memory_interface.html">The device_memory_interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_rom_interface.html">The device_rom_interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_disasm_interface.html">The device_disasm_interface and the disassemblers</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_sound_interface.html">The device_sound_interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory.html">Emulated system memory and address spaces management</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpu_device.html">CPU devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="floppy.html">The new floppy subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="nscsi.html">The new SCSI subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="m6502.html">The new 6502 family implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="uml_instructions.html">UML Instruction Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="poly_manager.html">Software 3D Rendering in MAME</a></li>
<li class="toctree-l2"><a class="reference internal" href="audio_effects.html">Audio effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="osd_audio.html">OSD audio support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">MAME and security concerns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">The MAME License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MAME Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Technical Specifications</a></li>
      <li class="breadcrumb-item active">MAME Layout Files</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mame-layout-files">
<span id="layfile"></span><h1>MAME Layout Files<a class="headerlink" href="#mame-layout-files" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#core-concepts" id="id2">Core concepts</a></p>
<ul>
<li><p><a class="reference internal" href="#numbers" id="id3">Numbers</a></p></li>
<li><p><a class="reference internal" href="#coordinates" id="id4">Coordinates</a></p></li>
<li><p><a class="reference internal" href="#colours" id="id5">Colours</a></p></li>
<li><p><a class="reference internal" href="#parameters" id="id6">Parameters</a></p></li>
<li><p><a class="reference internal" href="#pre-defined-parameters" id="id7">Pre-defined parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#parts-of-a-layout" id="id8">Parts of a layout</a></p>
<ul>
<li><p><a class="reference internal" href="#elements" id="id9">Elements</a></p></li>
<li><p><a class="reference internal" href="#views" id="id10">Views</a></p></li>
<li><p><a class="reference internal" href="#collections" id="id11">Collections</a></p></li>
<li><p><a class="reference internal" href="#reusable-groups" id="id12">Reusable groups</a></p></li>
<li><p><a class="reference internal" href="#repeating-blocks" id="id13">Repeating blocks</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#interactivity" id="id14">Interactivity</a></p>
<ul>
<li><p><a class="reference internal" href="#clickable-items" id="id15">Clickable items</a></p></li>
<li><p><a class="reference internal" href="#element-state" id="id16">Element state</a></p></li>
<li><p><a class="reference internal" href="#view-item-animation" id="id17">View item animation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#error-handling" id="id18">Error handling</a></p></li>
<li><p><a class="reference internal" href="#automatically-generated-views" id="id19">Automatically-generated views</a></p></li>
<li><p><a class="reference internal" href="#using-complay-py" id="id20">Using complay.py</a></p></li>
<li><p><a class="reference internal" href="#example-layout-files" id="id21">Example layout files</a></p></li>
</ul>
</nav>
<section id="introduction">
<span id="layfile-intro"></span><h2><a class="toc-backref" href="#id1" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>Layout files are used to tell MAME what to display when running an emulated
system, and how to arrange it.  MAME can render emulated screens, images, text,
shapes, and specialised objects for common output devices.  Elements can be
static, or dynamically update to reflect the state of inputs and outputs.
Layouts may be automatically generated based on the number/type of emulated
screens, built and linked into the MAME binary, or provided externally.  MAME
layout files are an XML application, using the <code class="docutils literal notranslate"><span class="pre">.lay</span></code> filename extension.</p>
</section>
<section id="core-concepts">
<span id="layfile-concepts"></span><h2><a class="toc-backref" href="#id2" role="doc-backlink">Core concepts</a><a class="headerlink" href="#core-concepts" title="Link to this heading">¶</a></h2>
<section id="numbers">
<span id="layfile-concepts-numbers"></span><h3><a class="toc-backref" href="#id3" role="doc-backlink">Numbers</a><a class="headerlink" href="#numbers" title="Link to this heading">¶</a></h3>
<p>There are two kinds of numbers in MAME layouts: integers and floating-point
numbers.</p>
<p>Integers may be supplied in decimal or hexadecimal notation.  A decimal integer
consists of an optional # (hash) prefix, an optional +/- (plus or minus) sign
character, and a sequence of digits 0-9.  A hexadecimal number consists of one
of the prefixes $ (dollar sign) or 0x (zero ex) followed by a sequence of
hexadecimal digits 0-9 and A-F.  Hexadecimal numbers are case-insensitive for
both the prefix and digits.</p>
<p>Floating-point numbers may be supplied in decimal fixed-point or scientific
notation.  Note that integer prefixes and hexadecimal values are <em>not</em>
accepted where a floating-point number is expected.</p>
<p>For a few attributes, both integers and floating-point numbers are allowed.  In
these cases, the presence of a # (hash), $ (dollar sign) or 0x (zero ex) prefix
causes the value to be interpreted as an integer.  If no recognised integer
prefix is found and the value contains a decimal point or the letter E
(uppercase or lowercase) introducing an exponent, it is interpreted as a
floating-point number.  If no integer prefix, decimal point or letter E is
found, the number will be interpreted as an integer.</p>
<p>Numbers are parsed using the &quot;C&quot; locale for portability.</p>
</section>
<section id="coordinates">
<span id="layfile-concepts-coordinates"></span><h3><a class="toc-backref" href="#id4" role="doc-backlink">Coordinates</a><a class="headerlink" href="#coordinates" title="Link to this heading">¶</a></h3>
<p>Layout coordinates are internally represented as IEEE754 32-bit binary
floating-point numbers (also known as “single precision”).  Coordinates increase
in the rightward and downward directions.  The origin (0,0) has no particular
significance, and you may freely use negative coordinates in layouts.
Coordinates are supplied as floating-point numbers.</p>
<p>MAME assumes that view coordinates have the same aspect ratio as pixels on the
output device (host screen or window).  Assuming square pixels and no rotation,
this means equal distances in X and Y axes correspond to equal horizontal and
vertical distances in the rendered output.</p>
<p>Views, groups and elements all have their own internal coordinate systems.  When
an element or group is referenced from a view or another group, its coordinates
are scaled as necessary to fit the specified bounds.</p>
<p>Objects are positioned and sized using <code class="docutils literal notranslate"><span class="pre">bounds</span></code> elements.  The horizontal
position and size may be specified in three ways: left edge and width using
<code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">width</span></code> attributes, horizontal centre and width using <code class="docutils literal notranslate"><span class="pre">xc</span></code> and
<code class="docutils literal notranslate"><span class="pre">width</span></code> attributes, or left and right edges using <code class="docutils literal notranslate"><span class="pre">left</span></code> and <code class="docutils literal notranslate"><span class="pre">right</span></code>
attributes.  Similarly, the vertical position and size may be specified in terms
of the top edge and height using <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">height</span></code> attributes, vertical
centre and height using <code class="docutils literal notranslate"><span class="pre">yc</span></code> and <code class="docutils literal notranslate"><span class="pre">height</span></code> attributes, or top and bottom
edges using <code class="docutils literal notranslate"><span class="pre">top</span></code> and <code class="docutils literal notranslate"><span class="pre">bottom</span></code> attributes.</p>
<p>These three <code class="docutils literal notranslate"><span class="pre">bounds</span></code> elements are equivalent:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;455&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;120&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;12&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;8&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">xc=</span><span class="s">&quot;461&quot;</span><span class="w"> </span><span class="na">yc=</span><span class="s">&quot;124&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;12&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;8&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">left=</span><span class="s">&quot;455&quot;</span><span class="w"> </span><span class="na">top=</span><span class="s">&quot;120&quot;</span><span class="w"> </span><span class="na">right=</span><span class="s">&quot;467&quot;</span><span class="w"> </span><span class="na">bottom=</span><span class="s">&quot;128&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>It’s possible to use different schemes in the horizontal and vertical
directions.  For example, these equivalent <code class="docutils literal notranslate"><span class="pre">bounds</span></code> elements are also valid:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;455&quot;</span><span class="w"> </span><span class="na">top=</span><span class="s">&quot;120&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;12&quot;</span><span class="w"> </span><span class="na">bottom=</span><span class="s">&quot;128&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">left=</span><span class="s">&quot;455&quot;</span><span class="w"> </span><span class="na">yc=</span><span class="s">&quot;124&quot;</span><span class="w"> </span><span class="na">right=</span><span class="s">&quot;467&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;8&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">width</span></code>/<code class="docutils literal notranslate"><span class="pre">height</span></code> or <code class="docutils literal notranslate"><span class="pre">right</span></code>/<code class="docutils literal notranslate"><span class="pre">bottom</span></code> default to 1.0 if not supplied.
It is an error if <code class="docutils literal notranslate"><span class="pre">width</span></code> or <code class="docutils literal notranslate"><span class="pre">height</span></code> are negative, if <code class="docutils literal notranslate"><span class="pre">right</span></code> is less
than <code class="docutils literal notranslate"><span class="pre">left</span></code>, or if <code class="docutils literal notranslate"><span class="pre">bottom</span></code> is less than <code class="docutils literal notranslate"><span class="pre">top</span></code>.</p>
</section>
<section id="colours">
<span id="layfile-concepts-colours"></span><h3><a class="toc-backref" href="#id5" role="doc-backlink">Colours</a><a class="headerlink" href="#colours" title="Link to this heading">¶</a></h3>
<p>Colours are specified in RGBA space.  MAME is not aware of colour profiles and
gamuts, so colours will typically be interpreted as sRGB with your system’s
target gamma (usually 2.2).  Channel values are specified as floating-point
numbers.  Red, green and blue channel values range from 0.0 (off) to 1.0 (full
intensity).  Alpha ranges from 0.0 (fully transparent) to 1.0 (opaque).  Colour
channel values are not pre-multiplied by the alpha value.</p>
<p>Component and view item colour is specified using <code class="docutils literal notranslate"><span class="pre">color</span></code> elements.
Meaningful attributes are <code class="docutils literal notranslate"><span class="pre">red</span></code>, <code class="docutils literal notranslate"><span class="pre">green</span></code>, <code class="docutils literal notranslate"><span class="pre">blue</span></code> and <code class="docutils literal notranslate"><span class="pre">alpha</span></code>.  This
example <code class="docutils literal notranslate"><span class="pre">color</span></code> element specifies all channel values:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;0.85&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;0.4&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.3&quot;</span><span class="w"> </span><span class="na">alpha=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Any omitted channel attributes default to 1.0 (full intensity or opaque).  It
is an error if any channel value falls outside the range of 0.0 to 1.0
(inclusive).</p>
</section>
<section id="parameters">
<span id="layfile-concepts-params"></span><h3><a class="toc-backref" href="#id6" role="doc-backlink">Parameters</a><a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h3>
<p>Parameters are named variables that can be used in most attributes.  To use
a parameter in an attribute, surround its name with tilde (~) characters.  If a
parameter is not defined, no substitution occurs.  Here is an examples showing
two instances of parameter use – the values of the <code class="docutils literal notranslate"><span class="pre">digitno</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span></code>
parameters will be substituted for <code class="docutils literal notranslate"><span class="pre">~digitno~</span></code> and <code class="docutils literal notranslate"><span class="pre">~x~</span></code>:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;digit~digitno~&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;digit&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;~x~&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;80&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;25&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;40&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/element&gt;</span>
</pre></div>
</div>
<p>A parameter name is a sequence of uppercase English letters A-Z, lowercase
English letters a-z, decimal digits 0-9, and/or underscore (_) characters.
Parameter names are case-sensitive.  When looking for a parameter, the layout
engine starts at the current, innermost scope and works outwards.  The outermost
scope level corresponds to the top-level <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element.  Each
<code class="docutils literal notranslate"><span class="pre">repeat</span></code>, <code class="docutils literal notranslate"><span class="pre">group</span></code> or <code class="docutils literal notranslate"><span class="pre">view</span></code> element creates a new, nested scope level.</p>
<p>Internally a parameter can hold a string, integer, or floating-point number, but
this is mostly transparent.  Integers are stored as 64-bit signed
twos-complement values, and floating-point numbers are stored as IEEE754 64-bit
binary floating-point numbers (also known as “double precision”).  Integers are
substituted in decimal notation, and floating point numbers are substituted in
default format, which may be decimal fixed-point or scientific notation
depending on the value).  There is no way to override the default formatting of
integer and floating-point number parameters.</p>
<p>There are two kinds of parameters: <em>value parameters</em> and <em>generator
parameters</em>.  Value parameters keep their assigned value until reassigned.
Generator parameters have a starting value and an increment and/or shift to be
applied for each iteration.</p>
<p>Value parameters are assigned using a <code class="docutils literal notranslate"><span class="pre">param</span></code> element with <code class="docutils literal notranslate"><span class="pre">name</span></code> and
<code class="docutils literal notranslate"><span class="pre">value</span></code> attributes.  Value parameters may appear inside the top-level
<code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element, inside <code class="docutils literal notranslate"><span class="pre">repeat</span></code>, and <code class="docutils literal notranslate"><span class="pre">view</span></code> elements, and inside
<code class="docutils literal notranslate"><span class="pre">group</span></code> definition elements (that is, <code class="docutils literal notranslate"><span class="pre">group</span></code> elements in the top-level
<code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element, as opposed to <code class="docutils literal notranslate"><span class="pre">group</span></code> reference elements inside
<code class="docutils literal notranslate"><span class="pre">view</span></code> elements other <code class="docutils literal notranslate"><span class="pre">group</span></code> definition elements).  A value parameter may
be reassigned at any point.</p>
<p>Here’s an example assigning the value “4” to the value parameter “firstdigit”:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;firstdigit&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;4&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Generator parameters are assigned using a <code class="docutils literal notranslate"><span class="pre">param</span></code> element with <code class="docutils literal notranslate"><span class="pre">name</span></code> and
<code class="docutils literal notranslate"><span class="pre">start</span></code> attributes, and <code class="docutils literal notranslate"><span class="pre">increment</span></code>, <code class="docutils literal notranslate"><span class="pre">lshift</span></code> and/or <code class="docutils literal notranslate"><span class="pre">rshift</span></code>
attributes.  Generator parameters may only appear inside <code class="docutils literal notranslate"><span class="pre">repeat</span></code> elements
(see <a class="reference internal" href="#layfile-parts-repeats"><span class="std std-ref">Repeating blocks</span></a> for details).  A generator parameter must not
be reassigned in the same scope (an identically named parameter may be defined
in a child scope).  Here are some example generator parameters:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nybble&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;3&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;-1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;switchpos&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;74&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;156&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mask&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0x0800&quot;</span><span class="w"> </span><span class="na">rshift=</span><span class="s">&quot;4&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">nybble</span></code> parameter generates values 3, 2, 1...</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">switchpos</span></code> parameter generates values 74, 230, 386...</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">mask</span></code> parameter generates values 2048, 128, 8...</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">increment</span></code> attribute must be an integer or floating-point number to be
added to the parameter’s value.  The <code class="docutils literal notranslate"><span class="pre">lshift</span></code> and <code class="docutils literal notranslate"><span class="pre">rshift</span></code> attributes must
be non-negative integers specifying numbers of bits to shift the parameter’s
value to the left or right.  The increment and shift are applied at the end of
the repeating block before the next iteration starts.  The parameter’s value
will be interpreted as an integer or floating-point number before the increment
and/or shift are applied.  If both an increment and shift are supplied, the
increment is applied before the shift.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">increment</span></code> attribute is present and is a floating-point number, the
parameter’s value will be converted to a floating-point number if necessary
before the increment is added.  If the <code class="docutils literal notranslate"><span class="pre">increment</span></code> attribute is present and is
an integer while the parameter’s value is a floating-point number, the increment
will be converted to a floating-point number before the addition.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">lshift</span></code> and/or <code class="docutils literal notranslate"><span class="pre">rshift</span></code> attributes are present and not equal, the
parameter’s value will be converted to an integer if necessary, and shifted
accordingly.  Shifting to the left is defined as shifting towards the most
significant bit.  If both <code class="docutils literal notranslate"><span class="pre">lshift</span></code> and <code class="docutils literal notranslate"><span class="pre">rshift</span></code> are supplied, they are
netted off before being applied.  This means you cannot, for example, use equal
<code class="docutils literal notranslate"><span class="pre">lshift</span></code> and <code class="docutils literal notranslate"><span class="pre">rshift</span></code> attributes to clear bits at one end of a parameter’s
value after the first iteration.</p>
<p>It is an error if a <code class="docutils literal notranslate"><span class="pre">param</span></code> element has neither <code class="docutils literal notranslate"><span class="pre">value</span></code> nor <code class="docutils literal notranslate"><span class="pre">start</span></code>
attributes, and it is an error if a <code class="docutils literal notranslate"><span class="pre">param</span></code> element has both a <code class="docutils literal notranslate"><span class="pre">value</span></code>
attribute and any of the <code class="docutils literal notranslate"><span class="pre">start</span></code>, <code class="docutils literal notranslate"><span class="pre">increment</span></code>, <code class="docutils literal notranslate"><span class="pre">lshift</span></code>, or <code class="docutils literal notranslate"><span class="pre">rshift</span></code>
attributes.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">param</span></code> element defines a parameter or reassigns its value in the current,
innermost scope.  It is not possible to define or reassign parameters in a
containing scope.</p>
</section>
<section id="pre-defined-parameters">
<span id="layfile-concepts-predef-params"></span><h3><a class="toc-backref" href="#id7" role="doc-backlink">Pre-defined parameters</a><a class="headerlink" href="#pre-defined-parameters" title="Link to this heading">¶</a></h3>
<p>A number of pre-defined value parameters are available providing information
about the running machine:</p>
<dl class="simple">
<dt>devicetag</dt><dd><p>The full tag path of the device that caused the layout to be loaded, for
example <code class="docutils literal notranslate"><span class="pre">:</span></code> for the root driver device, or <code class="docutils literal notranslate"><span class="pre">:tty:ie15</span></code> for a terminal
connected to a port.  This parameter is a string defined at layout (global)
scope.</p>
</dd>
<dt>devicebasetag</dt><dd><p>The base tag of the device that caused the layout to be loaded, for example
<code class="docutils literal notranslate"><span class="pre">root</span></code> for the root driver device, or <code class="docutils literal notranslate"><span class="pre">ie15</span></code> for a terminal connected to
a port.  This parameter is a string defined at layout (global) scope.</p>
</dd>
<dt>devicename</dt><dd><p>The full name (description) of the device that caused the layout to be
loaded, for example <code class="docutils literal notranslate"><span class="pre">AIM-65/40</span></code> or <code class="docutils literal notranslate"><span class="pre">IE15</span> <span class="pre">Terminal</span></code>.  This parameter is a
string defined at layout (global) scope.</p>
</dd>
<dt>deviceshortname</dt><dd><p>The short name of the device that caused the layout to be loaded, for
example <code class="docutils literal notranslate"><span class="pre">aim65_40</span></code> or <code class="docutils literal notranslate"><span class="pre">ie15_terminal</span></code>.  This parameter is a string
defined at layout (global) scope.</p>
</dd>
<dt>scr0physicalxaspect</dt><dd><p>The horizontal part of the physical aspect ratio of the first screen (if
present).  The physical aspect ratio is provided as a reduced improper
fraction.  Note that this is the horizontal component <em>before</em> rotation is
applied.  This parameter is an integer defined at layout (global) scope.</p>
</dd>
<dt>scr0physicalyaspect</dt><dd><p>The vertical part of the physical aspect ratio of the first screen (if
present).  The physical aspect ratio is provided as a reduced improper
fraction.  Note that this is the vertical component <em>before</em> rotation is
applied.  This parameter is an integer defined at layout (global) scope.</p>
</dd>
<dt>scr0nativexaspect</dt><dd><p>The horizontal part of the pixel aspect ratio of the first screen’s visible
area (if present).  The pixel aspect ratio is provided as a reduced improper
fraction.  Note that this is the horizontal component <em>before</em> rotation is
applied.  This parameter is an integer defined at layout (global) scope.</p>
</dd>
<dt>scr0nativeyaspect</dt><dd><p>The vertical part of the pixel aspect ratio of the first screen’s visible
area (if present).  The pixel aspect ratio is provided as a reduced improper
fraction.  Note that this is the vertical component <em>before</em> rotation is
applied.  This parameter is an integer defined at layout (global) scope.</p>
</dd>
<dt>scr0width</dt><dd><p>The width of the first screen’s visible area (if present) in emulated
pixels.  Note that this is the width <em>before</em> rotation is applied.  This
parameter is an integer defined at layout (global) scope.</p>
</dd>
<dt>scr0height</dt><dd><p>The height of the first screen’s visible area (if present) in emulated
pixels.  Note that this is the height <em>before</em> rotation is applied.  This
parameter is an integer defined at layout (global) scope.</p>
</dd>
<dt>scr1physicalxaspect</dt><dd><p>The horizontal part of the physical aspect ratio of the second screen (if
present).  This parameter is an integer defined at layout (global) scope.</p>
</dd>
<dt>scr1physicalyaspect</dt><dd><p>The vertical part of the physical aspect ratio of the second screen (if
present).  This parameter is an integer defined at layout (global) scope.</p>
</dd>
<dt>scr1nativexaspect</dt><dd><p>The horizontal part of the pixel aspect ratio of the second screen’s visible
area (if present).  This parameter is an integer defined at layout (global)
scope.</p>
</dd>
<dt>scr1nativeyaspect</dt><dd><p>The vertical part of the pixel aspect ratio of the second screen’s visible
area (if present).  This parameter is an integer defined at layout (global)
scope.</p>
</dd>
<dt>scr1width</dt><dd><p>The width of the second screen’s visible area (if present) in emulated
pixels.  This parameter is an integer defined at layout (global) scope.</p>
</dd>
<dt>scr1height</dt><dd><p>The height of the second screen’s visible area (if present) in emulated
pixels.  This parameter is an integer defined at layout (global) scope.</p>
</dd>
<dt>scr<em>N</em>physicalxaspect</dt><dd><p>The horizontal part of the physical aspect ratio of the (zero-based) <em>N</em>th
screen (if present).  This parameter is an integer defined at layout
(global) scope.</p>
</dd>
<dt>scr<em>N</em>physicalyaspect</dt><dd><p>The vertical part of the physical aspect ratio of the (zero-based) <em>N</em>th
screen (if present).  This parameter is an integer defined at layout
(global) scope.</p>
</dd>
<dt>scr<em>N</em>nativexaspect</dt><dd><p>The horizontal part of the pixel aspect ratio of the (zero-based) <em>N</em>th
screen’s visible area (if present).  This parameter is an integer defined at
layout (global) scope.</p>
</dd>
<dt>scr<em>N</em>nativeyaspect</dt><dd><p>The vertical part of the pixel aspect ratio of the (zero-based) <em>N</em>th
screen’s visible area (if present).  This parameter is an integer defined at
layout (global) scope.</p>
</dd>
<dt>scr<em>N</em>width</dt><dd><p>The width of the (zero-based) <em>N</em>th screen’s visible area (if present) in
emulated pixels.  This parameter is an integer defined at layout (global)
scope.</p>
</dd>
<dt>scr<em>N</em>height</dt><dd><p>The height of the (zero-based) <em>N</em>th screen’s visible area (if present) in
emulated pixels.  This parameter is an integer defined at layout (global)
scope.</p>
</dd>
<dt>viewname</dt><dd><p>The name of the current view.  This parameter is a string defined at view
scope.  It is not defined outside a view.</p>
</dd>
</dl>
<p>For screen-related parameters, screens are numbered from zero in the order they
appear in machine configuration, and all screens are included (not just
subdevices of the device that caused the layout to be loaded).  X/width and
Y/height refer to the horizontal and vertical dimensions of the screen <em>before</em>
rotation is applied.  Values based on the visible area are calculated at the
end of configuration.  Values are not updated and layouts are not recomputed if
the system reconfigures the screen while running.</p>
</section>
</section>
<section id="parts-of-a-layout">
<span id="layfile-parts"></span><h2><a class="toc-backref" href="#id8" role="doc-backlink">Parts of a layout</a><a class="headerlink" href="#parts-of-a-layout" title="Link to this heading">¶</a></h2>
<p>A <em>view</em> specifies an arrangement graphical object to display.  A MAME layout
file can contain multiple views.  Views are built up from <em>elements</em> and
<em>screens</em>.  To simplify complex layouts, reusable groups and repeating blocks
are supported.</p>
<p>The top-level element of a MAME layout file must be a <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element
with a <code class="docutils literal notranslate"><span class="pre">version</span></code> attribute.  The <code class="docutils literal notranslate"><span class="pre">version</span></code> attribute must be an integer.
Currently MAME only supports version 2, and will not load any other version.
This is an example opening tag for a top-level <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;mamelayout</span><span class="w"> </span><span class="na">version=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>In general, children of the top-level <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element are processed in
reading order from top to bottom.  The exception is that, for historical
reasons, views are processed last.  This means views see the final values of all
parameters at the end of the <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element, and may refer to elements
and groups that appear after them.</p>
<p>The following elements are allowed inside the top-level <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element:</p>
<dl class="simple">
<dt>param</dt><dd><p>Defines or reassigns a value parameter.  See <a class="reference internal" href="#layfile-concepts-params"><span class="std std-ref">Parameters</span></a>
for details.</p>
</dd>
<dt>element</dt><dd><p>Defines an element – one of the basic objects that can be arranged in a
view.  See <a class="reference internal" href="#layfile-parts-elements"><span class="std std-ref">Elements</span></a> for details.</p>
</dd>
<dt>group</dt><dd><p>Defines a reusable group of elements/screens that may be referenced from
views or other groups.  See <a class="reference internal" href="#layfile-parts-groups"><span class="std std-ref">Reusable groups</span></a> for details.</p>
</dd>
<dt>repeat</dt><dd><p>A repeating group of elements – may contain <code class="docutils literal notranslate"><span class="pre">param</span></code>, <code class="docutils literal notranslate"><span class="pre">element</span></code>,
<code class="docutils literal notranslate"><span class="pre">group</span></code>, and <code class="docutils literal notranslate"><span class="pre">repeat</span></code> elements.  See <a class="reference internal" href="#layfile-parts-repeats"><span class="std std-ref">Repeating blocks</span></a> for
details.</p>
</dd>
<dt>view</dt><dd><p>An arrangement of elements and/or screens that can be displayed on an output
device (a host screen/window).  See <a class="reference internal" href="#layfile-parts-views"><span class="std std-ref">Views</span></a> for details.</p>
</dd>
<dt>script</dt><dd><p>Allows Lua script to be supplied for enhanced interactive layouts.  See
<a class="reference internal" href="layout_script.html#layscript"><span class="std std-ref">MAME Layout Scripting</span></a> for details.</p>
</dd>
</dl>
<section id="elements">
<span id="layfile-parts-elements"></span><h3><a class="toc-backref" href="#id9" role="doc-backlink">Elements</a><a class="headerlink" href="#elements" title="Link to this heading">¶</a></h3>
<p>Elements are one of the basic visual objects that may be arranged, along with
screens, to make up a view. Elements may be built up of one or more <em>components</em>,
but an element is treated as a single surface when building the scene graph
and rendering.  An element may be used in multiple views, and may be used
multiple times within a view.</p>
<p>An element’s appearance depends on its <em>state</em>.  The state is an integer which
usually comes from an I/O port field or an emulated output (see
<a class="reference internal" href="#layfile-interact-elemstate"><span class="std std-ref">Element state</span></a> for information on connecting an element to an
emulated I/O port or output).  Any component of an element may be restricted to
only drawing when the element’s state is a particular value.  Some components
(e.g.  multi-segment displays) use the state directly to determine their
appearance.</p>
<p>Each element has its own internal coordinate system.  The bounds of the
element’s coordinate system are computed as the union of the bounds of the
individual components it’s composed of.</p>
<p>Every element must have a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute specifying its name.  Elements are
referred to by name when instantiated in groups or views.  It is an error for a
layout file to contain multiple elements with identical <code class="docutils literal notranslate"><span class="pre">name</span></code> attributes.
Elements may optionally supply a default state value with a <code class="docutils literal notranslate"><span class="pre">defstate</span></code>
attribute, to be used if not connected to an emulated output or I/O port.  If
present, the <code class="docutils literal notranslate"><span class="pre">defstate</span></code> attribute must be a non-negative integer.</p>
<p>Child elements of the <code class="docutils literal notranslate"><span class="pre">element</span></code> element instantiate components, which are
drawn into the element texture in reading order from first to last using alpha
blending (components draw over and may obscure components that come before
them).  All components support a few common features:</p>
<ul>
<li><p>Components may be conditionally drawn depending on the element’s state by
supplying <code class="docutils literal notranslate"><span class="pre">state</span></code> and/or <code class="docutils literal notranslate"><span class="pre">statemask</span></code> attributes.  If present, these
attributes must be non-negative integers.  If only the <code class="docutils literal notranslate"><span class="pre">state</span></code> attribute is
present, the component will only be drawn when the element’s state matches its
value.  If only the <code class="docutils literal notranslate"><span class="pre">statemask</span></code> attribute is present, the component will
only be drawn when all the bits that are set in its value are set in the
element’s state.</p>
<p>If both the <code class="docutils literal notranslate"><span class="pre">state</span></code> and <code class="docutils literal notranslate"><span class="pre">statemask</span></code> attributes are present, the component
will only be drawn when the bits in the element’s state corresponding to the
bits that are set in the <code class="docutils literal notranslate"><span class="pre">statemask</span></code> attribute’s value match the value of the
corresponding bits in the <code class="docutils literal notranslate"><span class="pre">state</span></code> attribute’s value.</p>
<p>(The component will always be drawn if neither <code class="docutils literal notranslate"><span class="pre">state</span></code> nor <code class="docutils literal notranslate"><span class="pre">statemask</span></code>
attributes are present, or if the <code class="docutils literal notranslate"><span class="pre">statemask</span></code> attribute’s value is zero.)</p>
</li>
<li><p>Each component may have a <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child element specifying its position and
size (see <a class="reference internal" href="#layfile-concepts-coordinates"><span class="std std-ref">Coordinates</span></a>).  If no such element is
present, the bounds default to a unit square (width and height of 1.0) with
the top left corner at (0,0).</p>
<p>A component’s position and/or size may be animated according to the element’s
state by supplying multiple <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child elements with <code class="docutils literal notranslate"><span class="pre">state</span></code>
attributes.  The <code class="docutils literal notranslate"><span class="pre">state</span></code> attribute of each <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child element must be
a non-negative integer.  The <code class="docutils literal notranslate"><span class="pre">state</span></code> attributes must not be equal for any
two <code class="docutils literal notranslate"><span class="pre">bounds</span></code> elements within a component.</p>
<p>If the element’s state is lower than the <code class="docutils literal notranslate"><span class="pre">state</span></code> value of any <code class="docutils literal notranslate"><span class="pre">bounds</span></code>
child element, the position/size specified by the <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child element
with the lowest <code class="docutils literal notranslate"><span class="pre">state</span></code> value will be used.  If the element’s state is
higher than the <code class="docutils literal notranslate"><span class="pre">state</span></code> value of any <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child element, the
position/size specified by the <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child element with the highest
<code class="docutils literal notranslate"><span class="pre">state</span></code> value will be used.  If the element’s state is between the <code class="docutils literal notranslate"><span class="pre">state</span></code>
values of two <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child elements, the position/size will be
interpolated linearly.</p>
</li>
<li><p>Each component may have a <code class="docutils literal notranslate"><span class="pre">color</span></code> child element specifying an RGBA colour
(see <a class="reference internal" href="#layfile-concepts-colours"><span class="std std-ref">Colours</span></a> for details).  This can be used to
control the colour of geometric, algorithmically drawn, or textual components.
For <code class="docutils literal notranslate"><span class="pre">image</span></code> components, the colour of the image pixels is multiplied by the
specified colour.  If no such element is present, the colour defaults to
opaque white.</p>
<p>A component’s color may be animated according to the element’s state by
supplying multiple <code class="docutils literal notranslate"><span class="pre">color</span></code> child elements with <code class="docutils literal notranslate"><span class="pre">state</span></code> attributes.  The
<code class="docutils literal notranslate"><span class="pre">state</span></code> attributes must not be equal for any two <code class="docutils literal notranslate"><span class="pre">color</span></code> elements within a
component.</p>
<p>If the element’s state is lower than the <code class="docutils literal notranslate"><span class="pre">state</span></code> value of any <code class="docutils literal notranslate"><span class="pre">color</span></code>
child element, the colour specified by the <code class="docutils literal notranslate"><span class="pre">color</span></code> child element with the
lowest <code class="docutils literal notranslate"><span class="pre">state</span></code> value will be used.  If the element’s state is higher than
the <code class="docutils literal notranslate"><span class="pre">state</span></code> value of any <code class="docutils literal notranslate"><span class="pre">color</span></code> child element, the colour specified by
the <code class="docutils literal notranslate"><span class="pre">color</span></code> child element with the highest <code class="docutils literal notranslate"><span class="pre">state</span></code> value will be used.  If
the element’s state is between the <code class="docutils literal notranslate"><span class="pre">state</span></code> values of two <code class="docutils literal notranslate"><span class="pre">color</span></code> child
elements, the RGBA colour components will be interpolated linearly.</p>
</li>
</ul>
<p>The following components are supported:</p>
<dl>
<dt>rect</dt><dd><p>Draws a uniform colour rectangle filling its bounds.</p>
</dd>
<dt>disk</dt><dd><p>Draws a uniform colour ellipse fitted to its bounds.</p>
</dd>
<dt>image</dt><dd><p>Draws an image loaded from a PNG, JPEG, Windows DIB (BMP) or SVG file.  The
name of the file to load (including the file name extension) is supplied
using the <code class="docutils literal notranslate"><span class="pre">file</span></code> attribute.  Additionally, an optional <code class="docutils literal notranslate"><span class="pre">alphafile</span></code>
attribute may be used to specify the name of a PNG file (including the file
name extension) to load into the alpha channel of the image.</p>
<p>Alternatively, image data may be supplied in the layout file itself using a
<code class="docutils literal notranslate"><span class="pre">data</span></code> child element.  This can be useful for supplying simple,
human-readable SVG graphics.  A <code class="docutils literal notranslate"><span class="pre">file</span></code> attribute or <code class="docutils literal notranslate"><span class="pre">data</span></code> child element
must be supplied; it is an error if neither or both are supplied.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">alphafile</span></code> attribute refers  to a file, it must have the same
dimensions (in pixels) as the file referred to by the <code class="docutils literal notranslate"><span class="pre">file</span></code> attribute,
and must have a bit depth no greater than eight bits per channel per pixel.
The intensity from this image (brightness) is copied to the alpha channel,
with full intensity (white in a greyscale image) corresponding to fully
opaque, and black corresponding to fully transparent. The <code class="docutils literal notranslate"><span class="pre">alphafile</span></code>
attribute will be ignored if the <code class="docutils literal notranslate"><span class="pre">file</span></code> attribute refers to an SVG image
or the <code class="docutils literal notranslate"><span class="pre">data</span></code> child element contains SVG data; it is only used in
conjunction with bitmap images.</p>
<p>The image file(s) should be placed in the same directory/archive as the
layout file.  Image file formats are detected by examining the content of
the files, file name extensions are ignored.</p>
</dd>
<dt>text</dt><dd><p>Draws text in using the UI font in the specified colour.  The text to draw
must be supplied using a <code class="docutils literal notranslate"><span class="pre">string</span></code> attribute.  An <code class="docutils literal notranslate"><span class="pre">align</span></code> attribute may
be supplied to set text alignment.  If present, the <code class="docutils literal notranslate"><span class="pre">align</span></code> attribute must
be an integer, where 0 (zero) means centred, 1 (one) means left-aligned, and
2 (two) means right-aligned.  If the <code class="docutils literal notranslate"><span class="pre">align</span></code> attribute is absent, the text
will be centred.</p>
</dd>
<dt>led7seg</dt><dd><p>Draws a standard seven-segment (plus decimal point) digital LED/fluorescent
display in the specified colour.  The low eight bits of the element’s state
control which segments are lit.  Starting from the least significant bit,
the bits correspond to the top segment, the upper right-hand segment,
continuing clockwise to the upper left segment, the middle bar, and the
decimal point.  Unlit segments are drawn at low intensity (0x20/0xff).</p>
</dd>
<dt>led14seg</dt><dd><p>Draws a standard fourteen-segment alphanumeric LED/fluorescent display in
the specified colour.  The low fourteen bits of the element’s state control
which segments are lit.  Starting from the least significant bit, the bits
correspond to the top segment, the upper right-hand segment, continuing
clockwise to the upper left segment, the left-hand and right-hand halves of
the horizontal middle bar, the upper and lower halves of the vertical middle
bar, and the diagonal bars clockwise from lower left to lower right.  Unlit
segments are drawn at low intensity (0x20/0xff).</p>
</dd>
<dt>led14segsc</dt><dd><p>Draws a standard fourteen-segment alphanumeric LED/fluorescent display with
decimal point/comma in the specified colour.  The low sixteen bits of the
element’s state control which segments are lit.  The low fourteen bits
correspond to the same segments as in the <code class="docutils literal notranslate"><span class="pre">led14seg</span></code> component.  Two
additional bits correspond to the decimal point and comma tail.  Unlit
segments are drawn at low intensity (0x20/0xff).</p>
</dd>
<dt>led16seg</dt><dd><p>Draws a standard sixteen-segment alphanumeric LED/fluorescent display in the
specified colour.  The low sixteen bits of the element’s state control which
segments are lit.  Starting from the least significant bit, the bits
correspond to the left-hand half of the top bar, the right-hand half of the
top bar, continuing clockwise to the upper left segment, the left-hand and
right-hand halves of the horizontal middle bar, the upper and lower halves
of the vertical middle bar, and the diagonal bars clockwise from lower left
to lower right.  Unlit segments are drawn at low intensity (0x20/0xff).</p>
</dd>
<dt>led16segsc</dt><dd><p>Draws a standard sixteen-segment alphanumeric LED/fluorescent display with
decimal point/comma in the specified colour.  The low eighteen bits of the
element’s state control which segments are lit.  The low sixteen bits
correspond to the same segments as in the <code class="docutils literal notranslate"><span class="pre">led16seg</span></code> component.  Two
additional bits correspond to the decimal point and comma tail.  Unlit
segments are drawn at low intensity (0x20/0xff).</p>
</dd>
<dt>simplecounter</dt><dd><p>Displays the numeric value of the element’s state using the system font in
the specified colour.  The value is formatted in decimal notation.  A
<code class="docutils literal notranslate"><span class="pre">digits</span></code> attribute may be supplied to specify the minimum number of digits
to display.  If present, the <code class="docutils literal notranslate"><span class="pre">digits</span></code> attribute must be a positive
integer; if absent, a minimum of two digits will be displayed.  A
<code class="docutils literal notranslate"><span class="pre">maxstate</span></code> attribute may be supplied to specify the maximum state value to
display.  If present, the <code class="docutils literal notranslate"><span class="pre">maxstate</span></code> attribute must be a non-negative
number; if absent it defaults to 999.  An <code class="docutils literal notranslate"><span class="pre">align</span></code> attribute may be supplied
to set text alignment.  If present, the <code class="docutils literal notranslate"><span class="pre">align</span></code> attribute must be an
integer, where 0 (zero) means centred, 1 (one) means left-aligned, and 2
(two) means right-aligned; if absent, the text will be centred.</p>
</dd>
</dl>
<p>An example element that draws a static left-aligned text string:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;label_reset_cpu&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">string=</span><span class="s">&quot;CPU&quot;</span><span class="w"> </span><span class="na">align=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;&lt;color</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/text&gt;</span>
<span class="nt">&lt;/element&gt;</span>
</pre></div>
</div>
<p>An example element that displays a circular LED where the intensity depends on
the state of an active-high output:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;led&quot;</span><span class="w"> </span><span class="na">defstate=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;disk</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;&lt;color</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;0.43&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;0.35&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.39&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/disk&gt;</span>
<span class="w">    </span><span class="nt">&lt;disk</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;&lt;color</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;0.18&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.20&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/disk&gt;</span>
<span class="nt">&lt;/element&gt;</span>
</pre></div>
</div>
<p>An example element for a button that gives visual feedback when clicked:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;btn_rst&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;rect</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;color</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;0.2&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;0.2&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.2&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/rect&gt;</span>
<span class="w">    </span><span class="nt">&lt;rect</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;color</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/rect&gt;</span>
<span class="w">    </span><span class="nt">&lt;rect</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;0.9&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;0.9&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;color</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/rect&gt;</span>
<span class="w">    </span><span class="nt">&lt;rect</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;0.9&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;0.9&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;color</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;0.2&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;0.2&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.2&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/rect&gt;</span>
<span class="w">    </span><span class="nt">&lt;rect&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;0.8&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;0.8&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;color</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;0.15&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;0.15&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.15&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/rect&gt;</span>
<span class="w">    </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">string=</span><span class="s">&quot;RESET&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;0.4&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;0.8&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;0.2&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;color</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/text&gt;</span>
<span class="nt">&lt;/element&gt;</span>
</pre></div>
</div>
<p>An example of an element that draws a seven-segment LED display using external
segment images:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;digit_a&quot;</span><span class="w"> </span><span class="na">defstate=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;image</span><span class="w"> </span><span class="na">file=</span><span class="s">&quot;a_off.png&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;image</span><span class="w"> </span><span class="na">file=</span><span class="s">&quot;a_a.png&quot;</span><span class="w"> </span><span class="na">statemask=</span><span class="s">&quot;0x01&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;image</span><span class="w"> </span><span class="na">file=</span><span class="s">&quot;a_b.png&quot;</span><span class="w"> </span><span class="na">statemask=</span><span class="s">&quot;0x02&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;image</span><span class="w"> </span><span class="na">file=</span><span class="s">&quot;a_c.png&quot;</span><span class="w"> </span><span class="na">statemask=</span><span class="s">&quot;0x04&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;image</span><span class="w"> </span><span class="na">file=</span><span class="s">&quot;a_d.png&quot;</span><span class="w"> </span><span class="na">statemask=</span><span class="s">&quot;0x08&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;image</span><span class="w"> </span><span class="na">file=</span><span class="s">&quot;a_e.png&quot;</span><span class="w"> </span><span class="na">statemask=</span><span class="s">&quot;0x10&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;image</span><span class="w"> </span><span class="na">file=</span><span class="s">&quot;a_f.png&quot;</span><span class="w"> </span><span class="na">statemask=</span><span class="s">&quot;0x20&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;image</span><span class="w"> </span><span class="na">file=</span><span class="s">&quot;a_g.png&quot;</span><span class="w"> </span><span class="na">statemask=</span><span class="s">&quot;0x40&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;image</span><span class="w"> </span><span class="na">file=</span><span class="s">&quot;a_dp.png&quot;</span><span class="w"> </span><span class="na">statemask=</span><span class="s">&quot;0x80&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/element&gt;</span>
</pre></div>
</div>
<p>An example of a bar graph that grows vertically and changes colour from green,
through yellow, to red as the state increases:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pedal&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;rect&gt;</span>
<span class="w">        </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0x000&quot;</span><span class="w"> </span><span class="na">left=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">top=</span><span class="s">&quot;0.9&quot;</span><span class="w"> </span><span class="na">right=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">bottom=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0x610&quot;</span><span class="w"> </span><span class="na">left=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">top=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">right=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">bottom=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0x000&quot;</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0x184&quot;</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0x610&quot;</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/rect&gt;</span>
<span class="nt">&lt;/element&gt;</span>
</pre></div>
</div>
<p>An example of a bar graph that grows horizontally to the left or right and
changes colour from green, through yellow, to red as the state changes from the
neutral position:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;wheel&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;rect&gt;</span>
<span class="w">        </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0x800&quot;</span><span class="w"> </span><span class="na">left=</span><span class="s">&quot;0.475&quot;</span><span class="w"> </span><span class="na">top=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">right=</span><span class="s">&quot;0.525&quot;</span><span class="w"> </span><span class="na">bottom=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0x280&quot;</span><span class="w"> </span><span class="na">left=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">top=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">right=</span><span class="s">&quot;0.525&quot;</span><span class="w"> </span><span class="na">bottom=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0xd80&quot;</span><span class="w"> </span><span class="na">left=</span><span class="s">&quot;0.475&quot;</span><span class="w"> </span><span class="na">top=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">right=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">bottom=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0x800&quot;</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0x3e0&quot;</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0x280&quot;</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0xc20&quot;</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0xd80&quot;</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;0.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/rect&gt;</span>
<span class="nt">&lt;/element&gt;</span>
</pre></div>
</div>
</section>
<section id="views">
<span id="layfile-parts-views"></span><h3><a class="toc-backref" href="#id10" role="doc-backlink">Views</a><a class="headerlink" href="#views" title="Link to this heading">¶</a></h3>
<p>A view defines an arrangement of elements and/or emulated screen images that can
be displayed in a window or on a screen.  Views also connect elements to
emulated I/O ports and/or outputs.  A layout file may contain multiple views.
If a view references a non-existent screen, it will be considered <em>unviable</em>.
MAME will print a warning message, skip over the unviable view, and continue to
load views from the layout file.  This is particularly useful for systems where
a screen is optional, for example computer systems with front panel controls and
an optional serial terminal.</p>
<p>Views are identified by name in MAME’s user interface and in command-line
options.  For layouts files associated with devices other than the root driver
device, view names are prefixed with the device’s tag (with the initial colon
omitted) – for example a view called “Keyboard LEDs” loaded for the device
<code class="docutils literal notranslate"><span class="pre">:tty:ie15</span></code> will be called “tty:ie15 Keyboard LEDs” in MAME’s user interface.
Views are listed in the order they are loaded.  Within a layout file, views are
loaded in the order they appear, from top to bottom.</p>
<p>Views are created with <code class="docutils literal notranslate"><span class="pre">view</span></code> elements inside the top-level <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code>
element.  Each <code class="docutils literal notranslate"><span class="pre">view</span></code> element must have a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute, supplying its
human-readable name for use in the user interface and command-line options.
This is an example of a valid opening tag for a <code class="docutils literal notranslate"><span class="pre">view</span></code> element:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;view</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Control panel&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>A view creates a nested parameter scope inside the parameter scope of the
top-level <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element.  For historical reasons, <code class="docutils literal notranslate"><span class="pre">view</span></code> elements are
processed <em>after</em> all other child elements of the top-level <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code>
element.  This means a view can reference elements and groups that appear after
it in the file, and parameters from the enclosing scope will have their final
values from the end of the <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">view</span></code> element may have a <code class="docutils literal notranslate"><span class="pre">showpointers</span></code> attribute to set whether mouse
and pen pointers should be shown for the view.  If present, the value must be
either <code class="docutils literal notranslate"><span class="pre">yes</span></code> or <code class="docutils literal notranslate"><span class="pre">no</span></code>.  If the <code class="docutils literal notranslate"><span class="pre">showpointers</span></code> attribute is not present, pen
and mouse pointers are shown for views that contain items bound to I/O ports.</p>
<p>The following child elements are allowed inside a <code class="docutils literal notranslate"><span class="pre">view</span></code> element:</p>
<dl>
<dt>bounds</dt><dd><p>Sets the origin and size of the view’s internal coordinate system if
present.  See <a class="reference internal" href="#layfile-concepts-coordinates"><span class="std std-ref">Coordinates</span></a> for details.  If absent,
the bounds of the view are computed as the union of the bounds of all
screens and elements within the view.  It only makes sense to have one
<code class="docutils literal notranslate"><span class="pre">bounds</span></code> as a direct child of a view element.  Any content outside the
view’s bounds is cropped, and the view is scaled proportionally to fit the
output window or screen.</p>
</dd>
<dt>param</dt><dd><p>Defines or reassigns a value parameter in the view’s scope.  See
<a class="reference internal" href="#layfile-concepts-params"><span class="std std-ref">Parameters</span></a> for details.</p>
</dd>
<dt>element</dt><dd><p>Adds an element to the view (see <a class="reference internal" href="#layfile-parts-elements"><span class="std std-ref">Elements</span></a>).  The name
of the element to add is specified using the required <code class="docutils literal notranslate"><span class="pre">ref</span></code> attribute.  It
is an error if no element with this name is defined in the layout file.
Within a view, elements are drawn in the order they appear in the layout
file, from front to back.  See below for more details.</p>
<p>May optionally be connected to an emulated I/O port using <code class="docutils literal notranslate"><span class="pre">inputtag</span></code> and
<code class="docutils literal notranslate"><span class="pre">inputmask</span></code> attributes, and/or an emulated output using a <code class="docutils literal notranslate"><span class="pre">name</span></code>
attribute.  See <a class="reference internal" href="#layfile-interact-clickable"><span class="std std-ref">Clickable items</span></a> for details.  See
<a class="reference internal" href="#layfile-interact-elemstate"><span class="std std-ref">Element state</span></a> for details on supplying a state value to
the instantiated element.</p>
</dd>
<dt>screen</dt><dd><p>Adds an emulated screen image to the view.  The screen must be identified
using either an <code class="docutils literal notranslate"><span class="pre">index</span></code> attribute or a <code class="docutils literal notranslate"><span class="pre">tag</span></code> attribute (it is an error
for a <code class="docutils literal notranslate"><span class="pre">screen</span></code> element to have both <code class="docutils literal notranslate"><span class="pre">index</span></code> and <code class="docutils literal notranslate"><span class="pre">tag</span></code> attributes).
If present, the <code class="docutils literal notranslate"><span class="pre">index</span></code> attribute must be a non-negative integer.  Screens
are numbered by the order they appear in machine configuration, starting at
zero (0).  If present, the <code class="docutils literal notranslate"><span class="pre">tag</span></code> attribute must be the tag path to the
screen relative to the device that causes the layout to be loaded.  Screens
are drawn in the order they appear in the layout file, from front to back.</p>
<p>May optionally be connected to an emulated I/O port using <code class="docutils literal notranslate"><span class="pre">inputtag</span></code> and
<code class="docutils literal notranslate"><span class="pre">inputmask</span></code> attributes, and/or an emulated output using a <code class="docutils literal notranslate"><span class="pre">name</span></code>
attribute.  See <a class="reference internal" href="#layfile-interact-clickable"><span class="std std-ref">Clickable items</span></a> for details.</p>
</dd>
<dt>collection</dt><dd><p>Adds screens and/or items in a collection that can be shown or hidden by the
user (see <a class="reference internal" href="#layfile-parts-collections"><span class="std std-ref">Collections</span></a>).  The name of the collection is
specified using the required <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute.  There is a limit of 32
collections per view.</p>
</dd>
<dt>group</dt><dd><p>Adds the content of the group to the view (see <a class="reference internal" href="#layfile-parts-groups"><span class="std std-ref">Reusable groups</span></a>).
The name of the group to add is specified using the required <code class="docutils literal notranslate"><span class="pre">ref</span></code>
attribute.  It is an error if no group with this name is defined in the
layout file.  See below for more details on positioning.</p>
</dd>
<dt>repeat</dt><dd><p>Repeats its contents the number of times specified by the required <code class="docutils literal notranslate"><span class="pre">count</span></code>
attribute.  The <code class="docutils literal notranslate"><span class="pre">count</span></code> attribute must be a positive integer.  A
<code class="docutils literal notranslate"><span class="pre">repeat</span></code> element in a view may contain <code class="docutils literal notranslate"><span class="pre">element</span></code>, <code class="docutils literal notranslate"><span class="pre">screen</span></code>, <code class="docutils literal notranslate"><span class="pre">group</span></code>,
and further <code class="docutils literal notranslate"><span class="pre">repeat</span></code> elements, which function the same way they do when
placed in a view directly.  See <a class="reference internal" href="#layfile-parts-repeats"><span class="std std-ref">Repeating blocks</span></a> for discussion
on using <code class="docutils literal notranslate"><span class="pre">repeat</span></code> elements.</p>
</dd>
</dl>
<p>Screens (<code class="docutils literal notranslate"><span class="pre">screen</span></code> elements) and layout elements (<code class="docutils literal notranslate"><span class="pre">element</span></code> elements) may
have an <code class="docutils literal notranslate"><span class="pre">id</span></code> attribute.  If present, the <code class="docutils literal notranslate"><span class="pre">id</span></code> attribute must not be empty,
and must be unique within a view, including screens and elements instantiated
via reusable groups and repeating blocks.  Screens and layout elements with
<code class="docutils literal notranslate"><span class="pre">id</span></code> attributes can be looked up by Lua scripts (see <a class="reference internal" href="layout_script.html#layscript"><span class="std std-ref">MAME Layout Scripting</span></a>).</p>
<p>Screens (<code class="docutils literal notranslate"><span class="pre">screen</span></code> elements), layout elements (<code class="docutils literal notranslate"><span class="pre">element</span></code> elements) and groups
(<code class="docutils literal notranslate"><span class="pre">group</span></code> elements) may have their orientation altered using an <code class="docutils literal notranslate"><span class="pre">orientation</span></code>
child element.  For screens, the orientation modifiers are applied in addition
to the orientation modifiers specified on the screen device and on the machine.
The <code class="docutils literal notranslate"><span class="pre">orientation</span></code> element supports the following attributes, all of which are
optional:</p>
<dl class="simple">
<dt>rotate</dt><dd><p>If present, applies clockwise rotation in ninety degree increments.  Must be
an integer equal to 0, 90, 180 or 270.</p>
</dd>
<dt>swapxy</dt><dd><p>Allows the screen, element or group to be mirrored along a line at
forty-five degrees to vertical from upper left to lower right.  Must be
either <code class="docutils literal notranslate"><span class="pre">yes</span></code> or <code class="docutils literal notranslate"><span class="pre">no</span></code> if present.  Mirroring applies logically after
rotation.</p>
</dd>
<dt>flipx</dt><dd><p>Allows the screen, element or group to be mirrored around its vertical axis,
from left to right.  Must be either <code class="docutils literal notranslate"><span class="pre">yes</span></code> or <code class="docutils literal notranslate"><span class="pre">no</span></code> if present.  Mirroring
applies logically after rotation.</p>
</dd>
<dt>flipy</dt><dd><p>Allows the screen, element or group to be mirrored around its horizontal
axis, from top to bottom.  Must be either <code class="docutils literal notranslate"><span class="pre">yes</span></code> or <code class="docutils literal notranslate"><span class="pre">no</span></code> if present.
Mirroring applies logically after rotation.</p>
</dd>
</dl>
<p>Screens (<code class="docutils literal notranslate"><span class="pre">screen</span></code> elements) and layout elements (<code class="docutils literal notranslate"><span class="pre">element</span></code> elements) may
have a <code class="docutils literal notranslate"><span class="pre">blend</span></code> attribute to set the blending mode.  Supported values are
<code class="docutils literal notranslate"><span class="pre">none</span></code> (no blending), <code class="docutils literal notranslate"><span class="pre">alpha</span></code> (alpha blending), <code class="docutils literal notranslate"><span class="pre">multiply</span></code> (RGB
multiplication), and <code class="docutils literal notranslate"><span class="pre">add</span></code> (additive blending).  The default for screens is to
allow the driver to specify blending per layer; the default blending mode for
layout elements is alpha blending.</p>
<p>Screens (<code class="docutils literal notranslate"><span class="pre">screen</span></code> elements), layout elements (<code class="docutils literal notranslate"><span class="pre">element</span></code> elements) and groups
(<code class="docutils literal notranslate"><span class="pre">group</span></code> elements) may be positioned and sized using a <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child
element (see <a class="reference internal" href="#layfile-concepts-coordinates"><span class="std std-ref">Coordinates</span></a> for details).  In the absence
of a <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child element, screens’ and layout elements’ bounds default to a
unit square (origin at 0,0 and height and width both equal to 1).  In the
absence of a <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child element, groups are expanded with no
translation/scaling (note that groups may position screens/elements outside
their bounds).  This example shows a view instantiating and positioning a
screen, an individual layout element, and two element groups:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;view</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LED Displays, Terminal and Keypad&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;screen</span><span class="w"> </span><span class="na">index=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;132&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;320&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;240&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/screen&gt;</span>
<span class="w">    </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;beige&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;320&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;172&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;372&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/element&gt;</span>
<span class="w">    </span><span class="nt">&lt;group</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;displays&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;320&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;132&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/group&gt;</span>
<span class="w">    </span><span class="nt">&lt;group</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;keypad&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;336&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;16&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;140&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;260&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/group&gt;</span>
<span class="nt">&lt;/view&gt;</span>
</pre></div>
</div>
<p>Screens (<code class="docutils literal notranslate"><span class="pre">screen</span></code> elements), layout elements (<code class="docutils literal notranslate"><span class="pre">element</span></code> elements) and groups
(<code class="docutils literal notranslate"><span class="pre">group</span></code> elements) may have a <code class="docutils literal notranslate"><span class="pre">color</span></code> child element (see
<a class="reference internal" href="#layfile-concepts-colours"><span class="std std-ref">Colours</span></a>) specifying a modifier colour.  The component
colours of the screen or layout element(s) are multiplied by this colour.</p>
<p>Screens (<code class="docutils literal notranslate"><span class="pre">screen</span></code> elements) and layout elements (<code class="docutils literal notranslate"><span class="pre">element</span></code> elements) may
have their colour and position/size animated by supplying multiple <code class="docutils literal notranslate"><span class="pre">color</span></code>
and/or <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child elements with <code class="docutils literal notranslate"><span class="pre">state</span></code> attributes.  See
<a class="reference internal" href="#layfile-interact-itemanim"><span class="std std-ref">View item animation</span></a> for details.</p>
<p>Layout elements (<code class="docutils literal notranslate"><span class="pre">element</span></code> elements) may be configured to show only part of
the element’s width or height using <code class="docutils literal notranslate"><span class="pre">xscroll</span></code> and/or <code class="docutils literal notranslate"><span class="pre">yscroll</span></code> child
elements.  This can be used for devices like slot machine reels.  The
<code class="docutils literal notranslate"><span class="pre">xscroll</span></code> and <code class="docutils literal notranslate"><span class="pre">yscroll</span></code> elements support the same attributes:</p>
<dl class="simple">
<dt>size</dt><dd><p>The size of the horizontal or vertical scroll window, as a proportion of the
element’s width or height, respectively.  Must be in the range 0.01 to 1.0,
inclusive, if present (1% of the width/height to the full width/height).  By
default, the entire width and height of the element is shown.</p>
</dd>
<dt>wrap</dt><dd><p>Whether the element should wrap horizontally or vertically.  Must be either
<code class="docutils literal notranslate"><span class="pre">yes</span></code> or <code class="docutils literal notranslate"><span class="pre">no</span></code> if present.  By default, items do not wrap horizontally or
vertically.</p>
</dd>
<dt>inputtag</dt><dd><p>If present, the horizontal or vertical scroll position will be taken from
the value of the corresponding I/O port.  Specifies the tag path of an I/O
port relative to the device that caused the layout file to be loaded.  The
raw value from the input port is used, active-low switch values are not
normalised.</p>
</dd>
<dt>name</dt><dd><p>If present, the horizontal or vertical scroll position will be taken from
the correspondingly named output.</p>
</dd>
<dt>mask</dt><dd><p>If present, the horizontal or vertical scroll position will be masked with
the value and shifted to the right to remove trailing zeroes (for example a
mask of 0x05 will result in no shift, while a mask of 0x68 will result in
the value being shifted three bits to the right).  Note that this applies to
output values (specified with the <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute) as well as input port
values (specified with the <code class="docutils literal notranslate"><span class="pre">inputtag</span></code> attribute).  Must be an integer
value if present.  If not present, it is equivalent to all 32 bits being
set.</p>
</dd>
<dt>min</dt><dd><p>Minimum horizontal or vertical scroll position value.  When the horizontal
or vertical scroll position has this value, the left or top edge or the
scroll window will be aligned with the left or top edge of the element.
Must be an integer value if present.  Defaults to zero.</p>
</dd>
<dt>max</dt><dd><p>Maximum horizontal or vertical scroll position value.  Must be an integer
value if present.  Defaults to the <code class="docutils literal notranslate"><span class="pre">mask</span></code> value shifted to the right to
remove trailing zeroes.</p>
</dd>
</dl>
</section>
<section id="collections">
<span id="layfile-parts-collections"></span><h3><a class="toc-backref" href="#id11" role="doc-backlink">Collections</a><a class="headerlink" href="#collections" title="Link to this heading">¶</a></h3>
<p>Collections of screens and/or layout elements can be shown or hidden by the user
as desired.  For example, a single view could include both displays and a
clickable keypad, and allow the user to hide the keypad leaving only the
displays visible.  Collections are created using <code class="docutils literal notranslate"><span class="pre">collection</span></code> elements inside
<code class="docutils literal notranslate"><span class="pre">view</span></code>, <code class="docutils literal notranslate"><span class="pre">group</span></code> and other <code class="docutils literal notranslate"><span class="pre">collection</span></code> elements.</p>
<p>A collection element must have a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute providing the display name
for the collection.  Collection names must be unique within a view.  The initial
visibility of a collection may be specified by providing a <code class="docutils literal notranslate"><span class="pre">visible</span></code>
attribute.  Set the <code class="docutils literal notranslate"><span class="pre">visible</span></code> attribute to <code class="docutils literal notranslate"><span class="pre">yes</span></code> if the collection should be
initially visible, or <code class="docutils literal notranslate"><span class="pre">no</span></code> if it should be initially hidden.  Collections are
initially visible by default.</p>
<p>Here is an example demonstrating the use of collections to allow parts of a view
to be hidden by the user:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;view</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LED Displays, CRT and Keypad&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;collection</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LED Displays&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;group</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;displays&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;240&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;320&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;47&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/group&gt;</span>
<span class="w">    </span><span class="nt">&lt;/collection&gt;</span>
<span class="w">    </span><span class="nt">&lt;collection</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Keypad&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;group</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;keypad&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;650&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;57&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;148&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;140&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/group&gt;</span>
<span class="w">    </span><span class="nt">&lt;/collection&gt;</span>
<span class="w">    </span><span class="nt">&lt;screen</span><span class="w"> </span><span class="na">tag=</span><span class="s">&quot;screen&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;57&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;640&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;480&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/screen&gt;</span>
<span class="nt">&lt;/view&gt;</span>
</pre></div>
</div>
<p>A collection creates a nested parameter scope.  Any <code class="docutils literal notranslate"><span class="pre">param</span></code> elements inside
the collection element set parameters in the local scope for the collection.
See <a class="reference internal" href="#layfile-concepts-params"><span class="std std-ref">Parameters</span></a> for more detail on parameters.  (Note that
the collection’s name and default visibility are not part of its content, and
any parameter references in the <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">visible</span></code> attributes themselves
will be substituted using parameter values from the collection’s parent’s
scope.)</p>
</section>
<section id="reusable-groups">
<span id="layfile-parts-groups"></span><h3><a class="toc-backref" href="#id12" role="doc-backlink">Reusable groups</a><a class="headerlink" href="#reusable-groups" title="Link to this heading">¶</a></h3>
<p>Groups allow an arrangement of screens and/or layout elements to be used
multiple times in views or other groups.  Groups can be beneficial even if you
only use the arrangement once, as they can be used to encapsulate part of a
complex layout.  Groups are defined using <code class="docutils literal notranslate"><span class="pre">group</span></code> elements inside the
top-level <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element, and instantiated using <code class="docutils literal notranslate"><span class="pre">group</span></code> elements
inside <code class="docutils literal notranslate"><span class="pre">view</span></code> and other <code class="docutils literal notranslate"><span class="pre">group</span></code> elements.</p>
<p>Each group definition element must have a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute providing a unique
identifier.  It is an error if a layout file contains multiple group definitions
with identical <code class="docutils literal notranslate"><span class="pre">name</span></code> attributes.  The value of the <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute is used
when instantiating the group from a view or another group.  This is an example
opening tag for a group definition element inside the top-level <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code>
element:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;group</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;panel&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>This group may then be instantiated in a view or another group element using a
group reference element, optionally supplying destination bounds, orientation,
and/or modifier colour.  The <code class="docutils literal notranslate"><span class="pre">ref</span></code> attribute identifies the group to
instantiate – in this example, destination bounds are supplied:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;group</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;panel&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;87&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;58&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;23&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;23.5&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/group&gt;</span>
</pre></div>
</div>
<p>Group definition elements allow all the same child elements as views.
Positioning and orienting screens, layout elements and nested groups works the
same way as for views.  See <a class="reference internal" href="#layfile-parts-views"><span class="std std-ref">Views</span></a> for details.  A group may
instantiate other groups, but recursive loops are not permitted.  It is an error
if a group directly or indirectly instantiates itself.</p>
<p>Groups have their own internal coordinate systems.  If a group definition
element has no <code class="docutils literal notranslate"><span class="pre">bounds</span></code> element as a direct child, its bounds are computed as
the union of the bounds of all the screens, layout elements and/or nested groups
it instantiates.  A <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child element may be used to explicitly specify
group bounds (see <a class="reference internal" href="#layfile-concepts-coordinates"><span class="std std-ref">Coordinates</span></a> for details).  Note that
groups’ bounds are only used for the purpose of calculating the coordinate
transform when instantiating a group.  A group may position screens and/or
elements outside its bounds, and they will not be cropped.</p>
<p>To demonstrate how bounds calculation works, consider this example:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;group</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;autobounds&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="cm">&lt;!-- bounds automatically calculated with origin at (5,10), width 30, and height 15 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;topleft&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;5&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/element&gt;</span>
<span class="w">    </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;bottomright&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;25&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;15&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/element&gt;</span>
<span class="nt">&lt;/group&gt;</span>

<span class="nt">&lt;view</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Test&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="cm">&lt;!--</span>
<span class="cm">        group bounds translated and scaled to fit - 2/3 scale horizontally and double vertically</span>
<span class="cm">        element topleft positioned at (0,0) with width 6.67 and height 20</span>
<span class="cm">        element bottomright positioned at (13.33,10) with width 6.67 and height 20</span>
<span class="cm">        view bounds calculated with origin at (0,0), width 20, and height 30</span>
<span class="cm">    --&gt;</span>
<span class="w">    </span><span class="nt">&lt;group</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;autobounds&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;20&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;30&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/group&gt;</span>
<span class="nt">&lt;/view&gt;</span>
</pre></div>
</div>
<p>This is relatively straightforward, as all elements inherently fall within the
group’s automatically computed bounds.  Now consider what happens if a group
positions elements outside its explicit bounds:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;group</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;periphery&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="cm">&lt;!-- elements are above the top edge and to the right of the right edge of the bounds --&gt;</span>
<span class="w">    </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;20&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;25&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;topleft&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/element&gt;</span>
<span class="w">    </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;bottomright&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;30&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;20&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/element&gt;</span>
<span class="nt">&lt;/group&gt;</span>

<span class="nt">&lt;view</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Test&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="cm">&lt;!--</span>
<span class="cm">        group bounds translated and scaled to fit - 3/2 scale horizontally and unity vertically</span>
<span class="cm">        element topleft positioned at (5,-5) with width 15 and height 10</span>
<span class="cm">        element bottomright positioned at (35,15) with width 15 and height 10</span>
<span class="cm">        view bounds calculated with origin at (5,-5), width 45, and height 30</span>
<span class="cm">    --&gt;</span>
<span class="w">    </span><span class="nt">&lt;group</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;periphery&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;5&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;5&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;30&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;25&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/group&gt;</span>
<span class="nt">&lt;/view&gt;</span>
</pre></div>
</div>
<p>The group’s elements are translated and scaled as necessary to distort the
group’s internal bounds to the destination bounds in the view.  The group’s
content is not restricted to its bounds.  The view considers the bounds of the
actual layout elements when computing its bounds, not the destination bounds
specified for the group.</p>
<p>When a group is instantiated, it creates a nested parameter scope.  The logical
parent scope is the parameter scope of the view, group or repeating block where
the group is instantiated (<em>not</em> its lexical parent, the top-level
<code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element).  Any <code class="docutils literal notranslate"><span class="pre">param</span></code> elements inside the group definition
element set parameters in the local scope for the group instantiation.  Local
parameters do not persist across multiple instantiations.  See
<a class="reference internal" href="#layfile-concepts-params"><span class="std std-ref">Parameters</span></a> for more detail on parameters.  (Note that the
group’s name is not part of its content, and any parameter references in the
<code class="docutils literal notranslate"><span class="pre">name</span></code> attribute itself will be substituted at the point where the group
definition appears in the top-level <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element’s scope.)</p>
</section>
<section id="repeating-blocks">
<span id="layfile-parts-repeats"></span><h3><a class="toc-backref" href="#id13" role="doc-backlink">Repeating blocks</a><a class="headerlink" href="#repeating-blocks" title="Link to this heading">¶</a></h3>
<p>Repeating blocks provide a concise way to generate or arrange large numbers of
similar elements.  Repeating blocks are generally used in conjunction with
generator parameters (see <a class="reference internal" href="#layfile-concepts-params"><span class="std std-ref">Parameters</span></a>).  Repeating blocks may
be nested for more complex arrangements.</p>
<p>Repeating blocks are created with <code class="docutils literal notranslate"><span class="pre">repeat</span></code> elements.  Each <code class="docutils literal notranslate"><span class="pre">repeat</span></code> element
requires a <code class="docutils literal notranslate"><span class="pre">count</span></code> attribute specifying the number of iterations to generate.
The <code class="docutils literal notranslate"><span class="pre">count</span></code> attribute must be a positive integer.  Repeating blocks are
allowed inside the top-level <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element, inside <code class="docutils literal notranslate"><span class="pre">group</span></code> and
<code class="docutils literal notranslate"><span class="pre">view</span></code> elements, and insider other <code class="docutils literal notranslate"><span class="pre">repeat</span></code> elements.  The exact child
elements allowed inside a <code class="docutils literal notranslate"><span class="pre">repeat</span></code> element depend on where it appears:</p>
<ul class="simple">
<li><p>A repeating block inside the top-level <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element may contain
<code class="docutils literal notranslate"><span class="pre">param</span></code>, <code class="docutils literal notranslate"><span class="pre">element</span></code>, <code class="docutils literal notranslate"><span class="pre">group</span></code> (definition), and <code class="docutils literal notranslate"><span class="pre">repeat</span></code> elements.</p></li>
<li><p>A repeating block inside a <code class="docutils literal notranslate"><span class="pre">group</span></code> or <code class="docutils literal notranslate"><span class="pre">view</span></code> element may contain
<code class="docutils literal notranslate"><span class="pre">param</span></code>, <code class="docutils literal notranslate"><span class="pre">element</span></code> (reference), <code class="docutils literal notranslate"><span class="pre">screen</span></code>, <code class="docutils literal notranslate"><span class="pre">group</span></code> (reference), and
<code class="docutils literal notranslate"><span class="pre">repeat</span></code> elements.</p></li>
</ul>
<p>A repeating block effectively repeats its contents the number of times specified
by its <code class="docutils literal notranslate"><span class="pre">count</span></code> attribute.  See the relevant sections for details on how the
child elements are used (<a class="reference internal" href="#layfile-parts"><span class="std std-ref">Parts of a layout</span></a>, <a class="reference internal" href="#layfile-parts-groups"><span class="std std-ref">Reusable groups</span></a>, and
<a class="reference internal" href="#layfile-parts-views"><span class="std std-ref">Views</span></a>).  A repeating block creates a nested parameter scope
inside the parameter scope of its lexical (DOM) parent element.</p>
<p>Generating white number labels from zero to eleven named <code class="docutils literal notranslate"><span class="pre">label_0</span></code>,
<code class="docutils literal notranslate"><span class="pre">label_1</span></code>, and so on (inside the top-level <code class="docutils literal notranslate"><span class="pre">mamelayout</span></code> element):</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;repeat</span><span class="w"> </span><span class="na">count=</span><span class="s">&quot;12&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;labelnum&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;label_~labelnum~&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">string=</span><span class="s">&quot;~labelnum~&quot;</span><span class="nt">&gt;&lt;color</span><span class="w"> </span><span class="na">red=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">green=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">blue=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/text&gt;</span>
<span class="w">    </span><span class="nt">&lt;/element&gt;</span>
<span class="nt">&lt;/repeat&gt;</span>
</pre></div>
</div>
<p>A horizontal row of forty digital displays, with five units space between them,
controlled by outputs <code class="docutils literal notranslate"><span class="pre">digit0</span></code> to <code class="docutils literal notranslate"><span class="pre">digit39</span></code> (inside a <code class="docutils literal notranslate"><span class="pre">group</span></code> or <code class="docutils literal notranslate"><span class="pre">view</span></code>
element):</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;repeat</span><span class="w"> </span><span class="na">count=</span><span class="s">&quot;40&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;i&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;x&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;5&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;30&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;digit~i~&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;digit&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;~x~&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;5&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;25&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;50&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/element&gt;</span>
<span class="nt">&lt;/repeat&gt;</span>
</pre></div>
</div>
<p>Eight five-by-seven dot matrix displays in a row, with pixels controlled by
outputs <code class="docutils literal notranslate"><span class="pre">Dot_000</span></code> to <code class="docutils literal notranslate"><span class="pre">Dot_764</span></code> (inside a <code class="docutils literal notranslate"><span class="pre">group</span></code> or <code class="docutils literal notranslate"><span class="pre">view</span></code> element):</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;repeat</span><span class="w"> </span><span class="na">count=</span><span class="s">&quot;8&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- 8 digits --&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;digitno&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;digitx&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;935&quot;</span><span class="w"> </span><span class="nt">/&gt;</span><span class="w"> </span><span class="cm">&lt;!-- distance between digits ((111 * 5) + 380) --&gt;</span>
<span class="w">    </span><span class="nt">&lt;repeat</span><span class="w"> </span><span class="na">count=</span><span class="s">&quot;7&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- 7 rows in each digit --&gt;</span>
<span class="w">        </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;rowno&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;rowy&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;114&quot;</span><span class="w"> </span><span class="nt">/&gt;</span><span class="w"> </span><span class="cm">&lt;!-- vertical distance between LEDs --&gt;</span>
<span class="w">        </span><span class="nt">&lt;repeat</span><span class="w"> </span><span class="na">count=</span><span class="s">&quot;5&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- 5 columns in each digit --&gt;</span>
<span class="w">            </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;colno&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;colx&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;~digitx~&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;111&quot;</span><span class="w"> </span><span class="nt">/&gt;</span><span class="w"> </span><span class="cm">&lt;!-- horizontal distance between LEDs --&gt;</span>
<span class="w">            </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Dot_~digitno~~rowno~~colno~&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;Pixel&quot;</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;~colx~&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;~rowy~&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;100&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;100&quot;</span><span class="w"> </span><span class="nt">/&gt;</span><span class="w"> </span><span class="cm">&lt;!-- size of each LED --&gt;</span>
<span class="w">            </span><span class="nt">&lt;/element&gt;</span>
<span class="w">        </span><span class="nt">&lt;/repeat&gt;</span>
<span class="w">    </span><span class="nt">&lt;/repeat&gt;</span>
<span class="nt">&lt;/repeat&gt;</span>
</pre></div>
</div>
<p>Two horizontally separated, clickable, four-by-four keypads (inside a <code class="docutils literal notranslate"><span class="pre">group</span></code>
or <code class="docutils literal notranslate"><span class="pre">view</span></code> element):</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;repeat</span><span class="w"> </span><span class="na">count=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;group&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;4&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;padx&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;530&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mask&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0x01&quot;</span><span class="w"> </span><span class="na">lshift=</span><span class="s">&quot;4&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;repeat</span><span class="w"> </span><span class="na">count=</span><span class="s">&quot;4&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;row&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;y&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;100&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;110&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;repeat</span><span class="w"> </span><span class="na">count=</span><span class="s">&quot;4&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;col&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;~group~&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;btnx&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;~padx~&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;110&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mask&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;~mask~&quot;</span><span class="w"> </span><span class="na">lshift=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;btn~row~~col~&quot;</span><span class="w"> </span><span class="na">inputtag=</span><span class="s">&quot;row~row~&quot;</span><span class="w"> </span><span class="na">inputmask=</span><span class="s">&quot;~mask~&quot;</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;~btnx~&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;~y~&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;80&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;80&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/element&gt;</span>
<span class="w">        </span><span class="nt">&lt;/repeat&gt;</span>
<span class="w">    </span><span class="nt">&lt;/repeat&gt;</span>
<span class="nt">&lt;/repeat&gt;</span>
</pre></div>
</div>
<p>The buttons are drawn using elements <code class="docutils literal notranslate"><span class="pre">btn00</span></code> in the top left, <code class="docutils literal notranslate"><span class="pre">bnt07</span></code> in the
top right, <code class="docutils literal notranslate"><span class="pre">btn30</span></code> in the bottom left, and <code class="docutils literal notranslate"><span class="pre">btn37</span></code> in the bottom right,
counting in between.  The four rows are connected to I/O ports <code class="docutils literal notranslate"><span class="pre">row0</span></code>,
<code class="docutils literal notranslate"><span class="pre">row1</span></code>, <code class="docutils literal notranslate"><span class="pre">row2</span></code>, and <code class="docutils literal notranslate"><span class="pre">row3</span></code>, from top to bottom.  The columns are connected
to consecutive I/O port bits, starting with the least significant bit on the
left.   Note that the <code class="docutils literal notranslate"><span class="pre">mask</span></code> parameter in the innermost <code class="docutils literal notranslate"><span class="pre">repeat</span></code> element
takes its initial value from the correspondingly named parameter in the
enclosing scope, but does not modify it.</p>
<p>Generating a chequerboard pattern with alternating alpha values 0.4 and 0.2
(inside a <code class="docutils literal notranslate"><span class="pre">group</span></code> or <code class="docutils literal notranslate"><span class="pre">view</span></code> element):</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;repeat</span><span class="w"> </span><span class="na">count=</span><span class="s">&quot;4&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pairy&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;3&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;20&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pairno&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;7&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;-2&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;repeat</span><span class="w"> </span><span class="na">count=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;rowy&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;~pairy~&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;rowno&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;~pairno~&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;-1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;lalpha&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0.4&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;-0.2&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ralpha&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0.2&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;0.2&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;repeat</span><span class="w"> </span><span class="na">count=</span><span class="s">&quot;4&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;lx&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;3&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;20&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;rx&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;13&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;20&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;lmask&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0x01&quot;</span><span class="w"> </span><span class="na">lshift=</span><span class="s">&quot;2&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;rmask&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0x02&quot;</span><span class="w"> </span><span class="na">lshift=</span><span class="s">&quot;2&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;hl&quot;</span><span class="w"> </span><span class="na">inputtag=</span><span class="s">&quot;board:IN.~rowno~&quot;</span><span class="w"> </span><span class="na">inputmask=</span><span class="s">&quot;~lmask~&quot;</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;~lx~&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;~rowy~&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">alpha=</span><span class="s">&quot;~lalpha~&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/element&gt;</span>
<span class="w">            </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;hl&quot;</span><span class="w"> </span><span class="na">inputtag=</span><span class="s">&quot;board:IN.~rowno~&quot;</span><span class="w"> </span><span class="na">inputmask=</span><span class="s">&quot;~rmask~&quot;</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;~rx~&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;~rowy~&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;color</span><span class="w"> </span><span class="na">alpha=</span><span class="s">&quot;~ralpha~&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/element&gt;</span>
<span class="w">        </span><span class="nt">&lt;/repeat&gt;</span>
<span class="w">    </span><span class="nt">&lt;/repeat&gt;</span>
<span class="nt">&lt;/repeat&gt;</span>
</pre></div>
</div>
<p>The outermost <code class="docutils literal notranslate"><span class="pre">repeat</span></code> element generates a group of two rows on each
iteration; the next <code class="docutils literal notranslate"><span class="pre">repeat</span></code> element generates an individual row on each
iteration; the innermost <code class="docutils literal notranslate"><span class="pre">repeat</span></code> element produces two horizontally adjacent
tiles on each iteration.  Rows are connected to I/O ports <code class="docutils literal notranslate"><span class="pre">board:IN.7</span></code> at the
top to <code class="docutils literal notranslate"><span class="pre">board.IN.0</span></code> at the bottom.</p>
</section>
</section>
<section id="interactivity">
<span id="layfile-interact"></span><h2><a class="toc-backref" href="#id14" role="doc-backlink">Interactivity</a><a class="headerlink" href="#interactivity" title="Link to this heading">¶</a></h2>
<p>Interactive views are supported by allowing items to be bound to emulated
outputs and I/O ports.  Five kinds of interactivity are supported:</p>
<dl class="simple">
<dt>Clickable items</dt><dd><p>If an item in a view is bound to an I/O port switch field, clicking the
item will activate the emulated switch.</p>
</dd>
<dt>State-dependent components</dt><dd><p>Some components will be drawn differently depending on the containing
element’s state.  These include the dot matrix, multi-segment LED display
and simple counter elements.  See <a class="reference internal" href="#layfile-parts-elements"><span class="std std-ref">Elements</span></a> for details.</p>
</dd>
<dt>Conditionally-drawn components</dt><dd><p>Components may be conditionally drawn or hidden depending on the containing
element’s state by supplying <code class="docutils literal notranslate"><span class="pre">state</span></code> and/or <code class="docutils literal notranslate"><span class="pre">statemask</span></code> attributes.  See
<a class="reference internal" href="#layfile-parts-elements"><span class="std std-ref">Elements</span></a> for details.</p>
</dd>
<dt>Component parameter animation</dt><dd><p>Components’ colour and position/size within their containing element may be
animated according the element’s state by providing multiple <code class="docutils literal notranslate"><span class="pre">color</span></code>
and/or <code class="docutils literal notranslate"><span class="pre">bounds</span></code> elements with <code class="docutils literal notranslate"><span class="pre">state</span></code> attributes.  See
<a class="reference internal" href="#layfile-parts-elements"><span class="std std-ref">Elements</span></a> for details.</p>
</dd>
<dt>Item parameter animation</dt><dd><p>Items’ colour and position/size within their containing view may be animated
according to their animation state.</p>
</dd>
</dl>
<section id="clickable-items">
<span id="layfile-interact-clickable"></span><h3><a class="toc-backref" href="#id15" role="doc-backlink">Clickable items</a><a class="headerlink" href="#clickable-items" title="Link to this heading">¶</a></h3>
<p>If a view item (<code class="docutils literal notranslate"><span class="pre">element</span></code> or <code class="docutils literal notranslate"><span class="pre">screen</span></code> element) has <code class="docutils literal notranslate"><span class="pre">inputtag</span></code> and
<code class="docutils literal notranslate"><span class="pre">inputmask</span></code> attribute values that correspond to a digital switch field in the
emulated system, clicking the element will activate the switch.  The switch
will remain active as long as the primary button is held down and the pointer is
within the item’s current bounds.  (Note that the bounds may change depending on
the item’s animation state, see <a class="reference internal" href="#layfile-interact-itemanim"><span class="std std-ref">View item animation</span></a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">inputtag</span></code> attribute specifies the tag path of an I/O port relative to the
device that caused the layout file to be loaded.  The <code class="docutils literal notranslate"><span class="pre">inputmask</span></code> attribute
must be an integer specifying the bits of the I/O port field that the item
should activate.  This sample shows instantiation of clickable buttons:</p>
<p>The <code class="docutils literal notranslate"><span class="pre">clickthrough</span></code> attribute controls whether clicks can pass through the view
item to other view items drawn above it.  The <code class="docutils literal notranslate"><span class="pre">clickthrough</span></code> attribute must be
<code class="docutils literal notranslate"><span class="pre">yes</span></code> or <code class="docutils literal notranslate"><span class="pre">no</span></code> if present.  The default is <code class="docutils literal notranslate"><span class="pre">no</span></code> (clicks do not pass
through) for view items with <code class="docutils literal notranslate"><span class="pre">inputtag</span></code> and <code class="docutils literal notranslate"><span class="pre">inputmask</span></code> attributes, and
<code class="docutils literal notranslate"><span class="pre">yes</span></code> (clicks pass through) for other view items.</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;btn_3&quot;</span><span class="w"> </span><span class="na">inputtag=</span><span class="s">&quot;X2&quot;</span><span class="w"> </span><span class="na">inputmask=</span><span class="s">&quot;0x10&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;2.30&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;4.325&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/element&gt;</span>
<span class="nt">&lt;element</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;btn_0&quot;</span><span class="w"> </span><span class="na">inputtag=</span><span class="s">&quot;X0&quot;</span><span class="w"> </span><span class="na">inputmask=</span><span class="s">&quot;0x20&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;0.725&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;5.375&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/element&gt;</span>
<span class="nt">&lt;element</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;btn_rst&quot;</span><span class="w"> </span><span class="na">inputtag=</span><span class="s">&quot;RESET&quot;</span><span class="w"> </span><span class="na">inputmask=</span><span class="s">&quot;0x01&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;1.775&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;5.375&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/element&gt;</span>
</pre></div>
</div>
<p>When handling pointer input, MAME treats all layout elements as being
rectangular.</p>
</section>
<section id="element-state">
<span id="layfile-interact-elemstate"></span><h3><a class="toc-backref" href="#id16" role="doc-backlink">Element state</a><a class="headerlink" href="#element-state" title="Link to this heading">¶</a></h3>
<p>A view item that instantiates an element (<code class="docutils literal notranslate"><span class="pre">element</span></code> element) may supply a
state value to the element from an emulated I/O port or output.  See
<a class="reference internal" href="#layfile-parts-elements"><span class="std std-ref">Elements</span></a> for details on how an element’s state affects its
appearance.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">element</span></code> element has a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute, the element state value
will be taken from the value of the correspondingly named emulated output.  Note
that output names are global, which can become an issue when a machine uses
multiple instances of the same type of device.  This example shows how digital
displays may be connected to emulated outputs:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;digit6&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;digit&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;16&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;16&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;48&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;80&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/element&gt;</span>
<span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;digit5&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;digit&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;64&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;16&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;48&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;80&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/element&gt;</span>
<span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;digit4&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;digit&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;112&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;16&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;48&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;80&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/element&gt;</span>
<span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;digit3&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;digit&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;160&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;16&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;48&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;80&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/element&gt;</span>
<span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;digit2&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;digit&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;208&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;16&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;48&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;80&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/element&gt;</span>
<span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;digit1&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;digit&quot;</span><span class="nt">&gt;&lt;bounds</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;256&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;16&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;48&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;80&quot;</span><span class="w"> </span><span class="nt">/&gt;&lt;/element&gt;</span>
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">element</span></code> element has <code class="docutils literal notranslate"><span class="pre">inputtag</span></code> and <code class="docutils literal notranslate"><span class="pre">inputmask</span></code> attributes but
lacks a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute, the element state value will be taken from the value
of the corresponding I/O port, masked with the <code class="docutils literal notranslate"><span class="pre">inputmask</span></code> value.  The
<code class="docutils literal notranslate"><span class="pre">inputtag</span></code> attribute specifies the tag path of an I/O port relative to the
device that caused the layout file to be loaded.  The <code class="docutils literal notranslate"><span class="pre">inputmask</span></code> attribute
must be an integer specifying the bits of the I/O port field to use.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">element</span></code> element has no <code class="docutils literal notranslate"><span class="pre">inputraw</span></code> attribute, or if the value of the
<code class="docutils literal notranslate"><span class="pre">inputraw</span></code> attribute is <code class="docutils literal notranslate"><span class="pre">no</span></code>, the I/O port’s value is masked with the
<code class="docutils literal notranslate"><span class="pre">inputmask</span></code> value and XORed with the I/O port default field value.  If the
result is non-zero, the element state is 1, otherwise it’s 0.  This is often
used or provide visual feedback for clickable buttons, as values for active-high
and active-low switches are normalised.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">element</span></code> element has an <code class="docutils literal notranslate"><span class="pre">inputraw</span></code> attribute with the value <code class="docutils literal notranslate"><span class="pre">yes</span></code>,
the element state will be taken from the I/O port’s value masked with the
<code class="docutils literal notranslate"><span class="pre">inputmask</span></code> value and shifted to the right to remove trailing zeroes (for
example a mask of 0x05 will result in no shift, while a mask of 0xb0 will result
in the value being shifted four bits to the right).  This is useful for
obtaining the value of analog or positional inputs.</p>
</section>
<section id="view-item-animation">
<span id="layfile-interact-itemanim"></span><h3><a class="toc-backref" href="#id17" role="doc-backlink">View item animation</a><a class="headerlink" href="#view-item-animation" title="Link to this heading">¶</a></h3>
<p>Items’ colour and position/size within their containing view may be animated.
This is achieved by supplying multiple <code class="docutils literal notranslate"><span class="pre">color</span></code> and/or <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child
elements with <code class="docutils literal notranslate"><span class="pre">state</span></code> attributes.  The <code class="docutils literal notranslate"><span class="pre">state</span></code> attribute of each <code class="docutils literal notranslate"><span class="pre">color</span></code>
or <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child element must be a non-negative integer.  Within a view
item, no two <code class="docutils literal notranslate"><span class="pre">color</span></code> elements may have equal state <code class="docutils literal notranslate"><span class="pre">state</span></code> attributes, and
no two <code class="docutils literal notranslate"><span class="pre">bounds</span></code> elements may have equal <code class="docutils literal notranslate"><span class="pre">state</span></code> attributes.</p>
<p>If the item’s animation state is lower than the <code class="docutils literal notranslate"><span class="pre">state</span></code> value of any
<code class="docutils literal notranslate"><span class="pre">bounds</span></code> child element, the position/size specified by the <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child
element with the lowest <code class="docutils literal notranslate"><span class="pre">state</span></code> value will be used.  If the item’s
animation state is higher than the <code class="docutils literal notranslate"><span class="pre">state</span></code> value of any <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child
element, the position/size specified by the <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child element with the
highest <code class="docutils literal notranslate"><span class="pre">state</span></code> value will be used.  If the item’s animation state is between
the <code class="docutils literal notranslate"><span class="pre">state</span></code> values of two <code class="docutils literal notranslate"><span class="pre">bounds</span></code> child elements, the position/size will be
interpolated linearly.</p>
<p>If the item’s animation state is lower than the <code class="docutils literal notranslate"><span class="pre">state</span></code> value of any <code class="docutils literal notranslate"><span class="pre">color</span></code>
child element, the colour specified by the <code class="docutils literal notranslate"><span class="pre">color</span></code> child element with the
lowest <code class="docutils literal notranslate"><span class="pre">state</span></code> value will be used.  If the item’s animation state is higher
than the <code class="docutils literal notranslate"><span class="pre">state</span></code> value of any <code class="docutils literal notranslate"><span class="pre">color</span></code> child element, the colour specified by
the <code class="docutils literal notranslate"><span class="pre">color</span></code> child element with the highest <code class="docutils literal notranslate"><span class="pre">state</span></code> value will be used.  If
the item’s animation state is between the <code class="docutils literal notranslate"><span class="pre">state</span></code> values of two <code class="docutils literal notranslate"><span class="pre">color</span></code>
child elements, the RGBA colour components will be interpolated linearly.</p>
<p>An item’s animation state may be bound to an emulated output or input port by
supplying an <code class="docutils literal notranslate"><span class="pre">animate</span></code> child element.  If present, the <code class="docutils literal notranslate"><span class="pre">animate</span></code> element
must have either an <code class="docutils literal notranslate"><span class="pre">inputtag</span></code> attribute or a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute (but not
both).  If the <code class="docutils literal notranslate"><span class="pre">animate</span></code> child element is not present, the item’s animation
state is the same as its element state (see <a class="reference internal" href="#layfile-interact-elemstate"><span class="std std-ref">Element state</span></a>).</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">animate</span></code> child element is present and has an <code class="docutils literal notranslate"><span class="pre">inputtag</span></code>
attribute, the item’s animation state will be taken from the value of the
corresponding I/O port.  The <code class="docutils literal notranslate"><span class="pre">inputtag</span></code> attribute specifies the tag path of an
I/O port relative to the device that caused the layout file to be loaded.  The
raw value from the input port is used, active-low switch values are not
normalised.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">animate</span></code> child element is present and has a <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute, the
item’s animation state will be taken from the value of the correspondingly named
emulated output.  Note that output names are global, which can become an issue
when a machine uses multiple instances of the same type of device.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">animate</span></code> child element has a <code class="docutils literal notranslate"><span class="pre">mask</span></code> attribute, the item’s animation
state will be masked with the <code class="docutils literal notranslate"><span class="pre">mask</span></code> value and shifted to the right to remove
trailing zeroes (for example a mask of 0x05 will result in no shift, while a
mask of 0xb0 will result in the value being shifted four bits to the right).
Note that the <code class="docutils literal notranslate"><span class="pre">mask</span></code> attribute applies to output values (specified with the
<code class="docutils literal notranslate"><span class="pre">name</span></code> attribute) as well as input port values (specified with the
<code class="docutils literal notranslate"><span class="pre">inputtag</span></code> attribute).  If the <code class="docutils literal notranslate"><span class="pre">mask</span></code> attribute is present, it must be an
integer value.  If the <code class="docutils literal notranslate"><span class="pre">mask</span></code> attribute is not present, it is equivalent to
all 32 bits being set.</p>
<p>This example shows elements with independent element state and animation state,
using the animation state taken from emulated outputs to control their
position:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;repeat</span><span class="w"> </span><span class="na">count=</span><span class="s">&quot;5&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;x&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;9&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;i&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mask&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0x01&quot;</span><span class="w"> </span><span class="na">lshift=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cg_sol~i~&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;cosmo&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;animate</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cg_count~i~&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;~x~&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;6&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;7&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;255&quot;</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;~x~&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;48.5&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;6&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;7&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/element&gt;</span>

<span class="w">    </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;nothing&quot;</span><span class="w"> </span><span class="na">inputtag=</span><span class="s">&quot;FAKE1&quot;</span><span class="w"> </span><span class="na">inputmask=</span><span class="s">&quot;~mask~&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;animate</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cg_count~i~&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;~x~&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;10&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;6&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;7&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;255&quot;</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;~x~&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;48.5&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;6&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;7&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/element&gt;</span>
<span class="nt">&lt;/repeat&gt;</span>
</pre></div>
</div>
<p>This example shows elements with independent element state and animation state,
using the animation state taken from an emulated positional input to control
their positions:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;repeat</span><span class="w"> </span><span class="na">count=</span><span class="s">&quot;4&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;y&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;3&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;param</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;n&quot;</span><span class="w"> </span><span class="na">start=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">increment=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;element</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;ledr&quot;</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;~n~.7&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;animate</span><span class="w"> </span><span class="na">inputtag=</span><span class="s">&quot;IN.1&quot;</span><span class="w"> </span><span class="na">mask=</span><span class="s">&quot;0x0f&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;~y~&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;bounds</span><span class="w"> </span><span class="na">state=</span><span class="s">&quot;11&quot;</span><span class="w"> </span><span class="na">x=</span><span class="s">&quot;16.5&quot;</span><span class="w"> </span><span class="na">y=</span><span class="s">&quot;~y~&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/element&gt;</span>
<span class="nt">&lt;/repeat&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="error-handling">
<span id="layfile-errors"></span><h2><a class="toc-backref" href="#id18" role="doc-backlink">Error handling</a><a class="headerlink" href="#error-handling" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>For internal (developer-supplied) layout files, errors detected by the
<code class="docutils literal notranslate"><span class="pre">complay.py</span></code> script result in a build failure.</p></li>
<li><p>MAME will stop loading a layout file if a syntax error is encountered.  No
views from the layout will be available.  Examples of syntax errors include
undefined element or group references, invalid bounds, invalid colours,
recursively nested groups, and redefined generator parameters.</p></li>
<li><p>When loading a layout file, if a view references a non-existent screen, MAME
will print a warning message and continue.  Views referencing non-existent
screens are considered unviable and not available to the user.</p></li>
</ul>
</section>
<section id="automatically-generated-views">
<span id="layfile-autogen"></span><h2><a class="toc-backref" href="#id19" role="doc-backlink">Automatically-generated views</a><a class="headerlink" href="#automatically-generated-views" title="Link to this heading">¶</a></h2>
<p>After loading internal (developer-supplied) and external (user-supplied)
layouts, MAME automatically generates views based on the machine configuration.
The following views will be automatically generated:</p>
<ul class="simple">
<li><p>If the system has no screens and no viable views were found in the internal
and external layouts, MAME will load a view that shows the message “No screens
attached to the system”.</p></li>
<li><p>For each emulated screen, MAME will generate a view showing the screen at its
physical aspect ratio with rotation applied.</p></li>
<li><p>For each emulated screen where the configured pixel aspect ratio doesn’t match
the physical aspect ratio, MAME will generate a view showing the screen at an
aspect ratio that produces square pixels, with rotation applied.</p></li>
<li><p>If the system has a single emulated screen, MAME will generate a view showing
two copies of the screen image above each other with a small gap between them.
The upper copy will be rotated by 180 degrees.  This view can be used in a
“cocktail table” cabinet for simultaneous two-player games, or alternating
play games that don’t automatically rotate the display for the second player.
The screen will be displayed at its physical aspect ratio, with rotation
applied.</p></li>
<li><p>If the system has exactly two emulated screens, MAME will generate a view
showing the second screen above the first screen with a small gap between
them.  The second screen will be rotated by 180 degrees.  This view can be
used to play a dual-screen two-player game on a “cocktail table” cabinet with
a single screen.  The screens will be displayed at their physical aspect
ratios, with rotation applied.</p></li>
<li><p>If the system has exactly two emulated screens and no view in the internal or
external layouts shows all screens, or if the system has more than two
emulated screens, MAME will generate views with the screens arranged
horizontally from left to right and vertically from top to bottom, both with
and without small gaps between them.  The screens will be displayed at
physical aspect ratio, with rotation applied.</p></li>
<li><p>If the system has three or more emulated screens, MAME will generate views
tiling the screens in grid patterns, in both row-major (left-to-right then
top-to-bottom) and column-major (top-to-bottom then left-to-right) order.
Views are generated with and without gaps between the screens.  The screens
will be displayed at physical aspect ratio, with rotation applied.</p></li>
</ul>
</section>
<section id="using-complay-py">
<span id="layfile-complay"></span><h2><a class="toc-backref" href="#id20" role="doc-backlink">Using complay.py</a><a class="headerlink" href="#using-complay-py" title="Link to this heading">¶</a></h2>
<p>The MAME source contains a Python script called <code class="docutils literal notranslate"><span class="pre">complay.py</span></code>, found in the
<code class="docutils literal notranslate"><span class="pre">scripts/build</span></code> subdirectory.  This script is used as part of MAME’s build
process to reduce the size of data for internal layouts and convert it to a form
that can be built into the executable.  However, it can also detect many common
layout file format errors, and generally provides better error messages than
MAME does when loading a layout file.  Note that it doesn’t actually run the
whole layout engine, so it can’t detect errors like undefined element references
when parameters are used, or recursively nested groups.  The <code class="docutils literal notranslate"><span class="pre">complay.py</span></code>
script is compatible with both Python 2.7 and Python 3 interpreters.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">complay.py</span></code> script takes three parameters – an input file name, an output
file name, and a base name for variables in the output:</p>
<blockquote>
<div><p><strong>python scripts/build/complay.py</strong> <em>&lt;input&gt;</em> [<em>&lt;output&gt;</em> [<em>&lt;varname&gt;</em>]]</p>
</div></blockquote>
<p>The input file name is required.  If no output file name is supplied,
<code class="docutils literal notranslate"><span class="pre">complay.py</span></code> will parse and check the input, reporting any errors found,
without producing output.  If no base variable name is provided, <code class="docutils literal notranslate"><span class="pre">complay.py</span></code>
will generate one based on the input file name.  This is not guaranteed to
produce valid identifiers.  The exit status is 0 (zero) on success, 1 on an
error in the command invocation, 2 if error are found in the input file, or 3
in case of an I/O error.  If an output file name is specified, the file will be
created/overwritten on success or removed on failure.</p>
<p>To check a layout file for common errors, run the script with the path to the
file to check and no output file name or base variable name.  For example:</p>
<blockquote>
<div><p><strong>python scripts/build/complay.py artwork/dino/default.lay</strong></p>
</div></blockquote>
</section>
<section id="example-layout-files">
<span id="layfile-examples"></span><h2><a class="toc-backref" href="#id21" role="doc-backlink">Example layout files</a><a class="headerlink" href="#example-layout-files" title="Link to this heading">¶</a></h2>
<p>These layout files demonstrate various artwork system features.  They are all
internal layouts included in MAME.</p>
<dl class="simple">
<dt><a class="reference external" href="https://git.redump.net/mame/tree/src/mame/layout/sstrangr.lay?h=mame0261">sstrangr.lay</a></dt><dd><p>A simple case of using translucent colour overlays to visually separate and
highlight elements on a black and white screen.</p>
</dd>
<dt><a class="reference external" href="https://git.redump.net/mame/tree/src/mame/layout/seawolf.lay?h=mame0261">seawolf.lay</a></dt><dd><p>This system uses lamps for key gameplay elements.  Blending modes are used
for the translucent colour overlay placed over the monitor, and the lamps
reflected in front of the monitor.  Also uses collections to allow parts of
the layout to be disabled selectively.</p>
</dd>
<dt><a class="reference external" href="https://git.redump.net/mame/tree/src/mame/layout/armora.lay?h=mame0261">armora.lay</a></dt><dd><p>This game’s monitor is viewed directly through a translucent colour overlay
rather than being reflected from inside the cabinet.  This means the overlay
reflects ambient light as well as affecting the colour of the video image.
The shapes on the overlay are drawn using embedded SVG images.</p>
</dd>
<dt><a class="reference external" href="https://git.redump.net/mame/tree/src/mame/layout/tranz330.lay?h=mame0261">tranz330.lay</a></dt><dd><p>A multi-segment alphanumeric display and keypad.  The keys are clickable,
and provide visual feedback when pressed.</p>
</dd>
<dt><a class="reference external" href="https://git.redump.net/mame/tree/src/mame/layout/esq2by16.lay?h=mame0261">esq2by16.lay</a></dt><dd><p>Builds up a multi-line dot matrix character display.  Repeats are used to
avoid repetition for the rows in a character, characters in a line, and
lines in a page.  Group colors allow a single element to be used for all
four display colours.</p>
</dd>
<dt><a class="reference external" href="https://git.redump.net/mame/tree/src/mame/layout/cgang.lay?h=mame0261">cgang.lay</a></dt><dd><p>Animates the position of element items to simulate an electromechanical
shooting gallery game.  Also demonstrates effective use of components to
build up complex graphics.</p>
</dd>
<dt><a class="reference external" href="https://git.redump.net/mame/tree/src/mame/layout/minspace.lay?h=mame0261">minspace.lay</a></dt><dd><p>Shows the position of a slider control with LEDs on it.</p>
</dd>
<dt><a class="reference external" href="https://git.redump.net/mame/tree/src/mame/layout/md6802.lay?h=mame0261">md6802.lay</a></dt><dd><p>Effectively using groups as a procedural programming language to build up an
image of a trainer board.</p>
</dd>
<dt><a class="reference external" href="https://git.redump.net/mame/tree/src/mame/layout/beena.lay?h=mame0261">beena.lay</a></dt><dd><p>Using event-based scripting to dynamically position elements and draw elemnt
content programmatically.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="naming.html" class="btn btn-neutral float-left" title="MAME Naming Conventions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="layout_script.html" class="btn btn-neutral float-right" title="MAME Layout Scripting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1997-2025, MAMEdev and contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>