<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The device_rom_interface &mdash; MAME Documentation 0.279 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=1a7c6e39"></script>
        <script src="../_static/doctools.js?v=9bcbadda"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The device_disasm_interface and the disassemblers" href="device_disasm_interface.html" />
    <link rel="prev" title="The device_memory_interface" href="device_memory_interface.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MAME Documentation
          </a>
              <div class="version">
                0.279
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../whatis.html">What is MAME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../healthwarning.html">Health Warnings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../initialsetup/index.html">Getting MAME prepared</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usingmame/index.html">Basic MAME Usage and Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commandline/index.html">MAME Command-line Usage and OS-Specific Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/index.html">Advanced configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debugger/index.html">MAME Debugger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../luascript/index.html">Lua Scripting Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">MAME External Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing to MAME</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Technical Specifications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="naming.html">MAME Naming Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="layout_files.html">MAME Layout Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="layout_script.html">MAME Layout Scripting</a></li>
<li class="toctree-l2"><a class="reference internal" href="object_finders.html">Object Finders</a></li>
<li class="toctree-l2"><a class="reference internal" href="inputsystem.html">Input System</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_memory_interface.html">The device_memory_interface</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">The device_rom_interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_disasm_interface.html">The device_disasm_interface and the disassemblers</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_sound_interface.html">The device_sound_interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory.html">Emulated system memory and address spaces management</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpu_device.html">CPU devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="floppy.html">The new floppy subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="nscsi.html">The new SCSI subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="m6502.html">The new 6502 family implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="uml_instructions.html">UML Instruction Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="poly_manager.html">Software 3D Rendering in MAME</a></li>
<li class="toctree-l2"><a class="reference internal" href="audio_effects.html">Audio effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="osd_audio.html">OSD audio support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">MAME and security concerns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">The MAME License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MAME Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Technical Specifications</a></li>
      <li class="breadcrumb-item active">The device_rom_interface</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="the-device-rom-interface">
<h1>The device_rom_interface<a class="headerlink" href="#the-device-rom-interface" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#capabilities" id="id1">1. Capabilities</a></p></li>
<li><p><a class="reference internal" href="#setup" id="id2">2. Setup</a></p></li>
<li><p><a class="reference internal" href="#rom-access" id="id3">3. ROM access</a></p></li>
<li><p><a class="reference internal" href="#rom-banking" id="id4">4. ROM banking</a></p></li>
<li><p><a class="reference internal" href="#caveats" id="id5">5. Caveats</a></p></li>
</ul>
</nav>
<section id="capabilities">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">1. Capabilities</a><a class="headerlink" href="#capabilities" title="Link to this heading">¶</a></h2>
<p>This interface is designed for devices that expect to have a ROM
connected to them on a dedicated bus.  It’s mostly designed for sound
chips.  Other devices types may be interested but other considerations
may make it impractical (graphics decode caching, for instance).  The
interface provides the capability to connect a ROM region, connect an
address map, or dynamically set up a block of memory as ROM.  In the
region/memory block cases, banking is handled automatically.</p>
</section>
<section id="setup">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">2. Setup</a><a class="headerlink" href="#setup" title="Link to this heading">¶</a></h2>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">device_rom_interface</span><span class="o">&lt;</span><span class="n">AddrWidth</span><span class="p">,</span><span class="w"> </span><span class="n">DataWidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">AddrShift</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Endian</span><span class="o">=</span><span class="n">ENDIANNESS_LITTLE</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The interface is a template that takes the address width of the
dedicated bus as a parameter.  In addition the data bus width (if not
byte), address shift (if non-zero) and Endianness (if not little Endian
or byte-sized bus) can be provided.  Data bus width is 0 for byte, 1
for word, etc.</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">set_map</span><span class="p">(</span><span class="n">map</span><span class="p">);</span>
</pre></div>
</div>
<p>Use that method at machine configuration time to provide an address map
for the bus to connect to.  It has priority over a ROM region if one is
also present.</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">set_device_rom_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">);</span>
</pre></div>
</div>
<p>Used to specify a ROM region to use if a device address map is not
given.  Defaults to <code class="docutils literal notranslate"><span class="pre">DEVICE_SELF</span></code>, i.e. the device’s tag.</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">ROM_REGION</span><span class="p">(</span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="n">flags</span><span class="p">)</span>
</pre></div>
</div>
<p>If a ROM region with the tag specified using <code class="docutils literal notranslate"><span class="pre">set_device_rom_tag</span></code> if
present, or identical to the device tag otherwise, is provided in the
ROM definitions for the system, it will be automatically picked up as
the connected ROM.  An address map has priority over the region if
present in the machine configuration.</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">override_address_width</span><span class="p">(</span><span class="n">u8</span><span class="w"> </span><span class="n">width</span><span class="p">);</span>
</pre></div>
</div>
<p>This method allows the address bus width to be overridden. It must be
called from within the device before <strong>config_complete</strong> time.</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">set_rom</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">base</span><span class="p">,</span><span class="w"> </span><span class="n">u32</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
</pre></div>
</div>
<p>At any time post-<code class="docutils literal notranslate"><span class="pre">interface_pre_start</span></code>, a memory block can be
set up as the connected ROM with that method.  It overrides any
previous setup that may have been provided.  It can be done multiple
times.</p>
</section>
<section id="rom-access">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">3. ROM access</a><a class="headerlink" href="#rom-access" title="Link to this heading">¶</a></h2>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">u8</span><span class="w"> </span><span class="nf">read_byte</span><span class="p">(</span><span class="n">offs_t</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span>
<span class="n">u16</span><span class="w"> </span><span class="nf">read_word</span><span class="p">(</span><span class="n">offs_t</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span>
<span class="n">u32</span><span class="w"> </span><span class="nf">read_dword</span><span class="p">(</span><span class="n">offs_t</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span>
<span class="n">u64</span><span class="w"> </span><span class="nf">read_qword</span><span class="p">(</span><span class="n">offs_t</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span>
</pre></div>
</div>
<p>These methods provide read access to the connected ROM.  Out-of-bounds
access results in standard unmapped read <code class="docutils literal notranslate"><span class="pre">logerror</span></code> messages.</p>
</section>
<section id="rom-banking">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">4. ROM banking</a><a class="headerlink" href="#rom-banking" title="Link to this heading">¶</a></h2>
<p>If the ROM region or the memory block in <code class="docutils literal notranslate"><span class="pre">set_rom</span></code> is larger than the
address bus can access, banking is automatically set up.</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">set_rom_bank</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">bank</span><span class="p">);</span>
</pre></div>
</div>
<p>That method selects the current bank number.</p>
</section>
<section id="caveats">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">5. Caveats</a><a class="headerlink" href="#caveats" title="Link to this heading">¶</a></h2>
<p>Using that interface makes the device derive from
<code class="docutils literal notranslate"><span class="pre">device_memory_interface</span></code>.  If the device wants to actually use the
memory interface for itself, remember that space zero (0, or
<code class="docutils literal notranslate"><span class="pre">AS_PROGRAM</span></code>) is used by the ROM interface, and don’t forget to call
the base <code class="docutils literal notranslate"><span class="pre">memory_space_config</span></code> method.</p>
<p>For devices which have outputs that can be used to address ROMs but only
to forward the data to another device for processing, it may be helpful
to disable the interface when it is not required.  This can be done by
overriding <code class="docutils literal notranslate"><span class="pre">memory_space_config</span></code> to return an empty vector.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="device_memory_interface.html" class="btn btn-neutral float-left" title="The device_memory_interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="device_disasm_interface.html" class="btn btn-neutral float-right" title="The device_disasm_interface and the disassemblers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1997-2025, MAMEdev and contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>