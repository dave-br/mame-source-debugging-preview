<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MAME Debugger &mdash; MAME Documentation 0.280 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=e8156010"></script>
        <script src="../_static/doctools.js?v=9bcbadda"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="General Debugger Commands" href="general.html" />
    <link rel="prev" title="Linux Lightguns" href="../advanced/linux-lightguns.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MAME Documentation
          </a>
              <div class="version">
                0.280
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../whatis.html">What is MAME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../healthwarning.html">Health Warnings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../initialsetup/index.html">Getting MAME prepared</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usingmame/index.html">Basic MAME Usage and Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commandline/index.html">MAME Command-line Usage and OS-Specific Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/index.html">Advanced configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">MAME Debugger</a><ul>
<li class="toctree-l2"><a class="reference internal" href="general.html">General Debugger Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory.html">Memory Debugger Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="execution.html">Execution Debugger Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="breakpoint.html">Breakpoint Debugger Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="watchpoint.html">Watchpoint Debugger Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="registerpoints.html">Registerpoint Debugger Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="exceptionpoint.html">Exceptionpoint Debugger Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="annotation.html">Code Annotation Debugger Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="cheats.html">Cheat Debugger Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="image.html">Media Image Debugger Commands</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../luascript/index.html">Lua Scripting Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">MAME External Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing to MAME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../techspecs/index.html">Technical Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">MAME and security concerns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">The MAME License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MAME Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">MAME Debugger</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mame-debugger">
<span id="debugger"></span><h1>MAME Debugger<a class="headerlink" href="#mame-debugger" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#debugger-commands" id="id2">Debugger commands</a></p></li>
<li><p><a class="reference internal" href="#specifying-devices-and-address-spaces" id="id3">Specifying devices and address spaces</a></p></li>
<li><p><a class="reference internal" href="#debugger-expression-syntax" id="id4">Debugger expression syntax</a></p>
<ul>
<li><p><a class="reference internal" href="#numbers" id="id5">Numbers</a></p></li>
<li><p><a class="reference internal" href="#boolean-values" id="id6">Boolean values</a></p></li>
<li><p><a class="reference internal" href="#memory-accesses" id="id7">Memory accesses</a></p></li>
<li><p><a class="reference internal" href="#functions" id="id8">Functions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#source-level-debugging" id="id9">Source-level debugging</a></p>
<ul>
<li><p><a class="reference internal" href="#enabling-source-level-debugging" id="id10">Enabling source-level debugging</a></p></li>
<li><p><a class="reference internal" href="#source-level-breakpoints" id="id11">Source-level breakpoints</a></p></li>
<li><p><a class="reference internal" href="#source-level-stepping" id="id12">Source-level stepping</a></p></li>
<li><p><a class="reference internal" href="#source-level-symbol-evaluation" id="id13">Source-level symbol evaluation</a></p></li>
<li><p><a class="reference internal" href="#address-offsets" id="id14">Address offsets</a></p></li>
<li><p><a class="reference internal" href="#generating-mame-debugging-information-files" id="id15">Generating MAME Debugging Information Files</a></p></li>
<li><p><a class="reference internal" href="#viewing-mame-debugging-information-files-with-srcdbgdump" id="id16">Viewing MAME Debugging Information Files with srcdbgdump</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<span id="debugger-intro"></span><h2><a class="toc-backref" href="#id1" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>MAME includes an interactive low-level debugger that targets the
emulated system.  This can be a useful tool for diagnosing emulation
issues, developing software to run on vintage systems, creating cheats,
ROM hacking, or just investigating how software works.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">-debug</span></code> command line option to start MAME with the debugger
activated.  By default, pressing the backtick/tilde (<strong>~</strong>) during
emulation breaks into the debugger (this can be changed by reassigning
the <strong>Break in Debugger</strong> input).</p>
<p>The exact appearance of the debugger depends on your operating system
and the options MAME was built with.  All variants of the debugger
provide a multi-window interface for viewing the contents of memory and
disassembled code.</p>
<p>The debugger console window is a special window that shows the contents
of CPU registers and disassembled code around the current program
counter address, and provides a command-line interface to most of the
debugging functionality.</p>
</section>
<section id="debugger-commands">
<span id="debugger-sections-list"></span><h2><a class="toc-backref" href="#id2" role="doc-backlink">Debugger commands</a><a class="headerlink" href="#debugger-commands" title="Link to this heading">¶</a></h2>
<p>Debugger commands are described in the sections below.  You can also
type <strong>help &lt;topic&gt;</strong> in the debugger console, where <strong>&lt;topic&gt;</strong> is the
name of a command, to see documentation directly in MAME.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="general.html">General Debugger Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="memory.html">Memory Debugger Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="execution.html">Execution Debugger Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="breakpoint.html">Breakpoint Debugger Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="watchpoint.html">Watchpoint Debugger Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="registerpoints.html">Registerpoint Debugger Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptionpoint.html">Exceptionpoint Debugger Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="annotation.html">Code Annotation Debugger Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="cheats.html">Cheat Debugger Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="image.html">Media Image Debugger Commands</a></li>
</ul>
</div>
</section>
<section id="specifying-devices-and-address-spaces">
<span id="debugger-devicespec"></span><h2><a class="toc-backref" href="#id3" role="doc-backlink">Specifying devices and address spaces</a><a class="headerlink" href="#specifying-devices-and-address-spaces" title="Link to this heading">¶</a></h2>
<p>Many debugger commands accept parameters specifying which device to
operate on.  If a device is not specified explicitly, the CPU currently
visible in the debugger is used.  Devices can be specified by tag, or by
CPU number:</p>
<ul class="simple">
<li><p>Tags are the colon-separated paths that MAME uses to identify devices
within a system.  You see them in options for configuring slot
devices, in debugger disassembly and memory viewer source lists, and
various other places within MAME’s UI.</p></li>
<li><p>CPU numbers are monotonically incrementing numbers that the debugger
assigns to CPU-like devices within a system, starting at zero.  The
<strong>cpunum</strong> symbol holds the CPU number for the currently visible CPU
in the debugger (you can see it by entering the command
<strong>print cpunum</strong> in the debugger console).</p></li>
</ul>
<p>If a tag starts with a caret (<strong>^</strong>) or dot (<strong>.</strong>), it is interpreted
relative to the CPU currently visible in the debugger, otherwise it is
interpreted relative to the root machine device.  If a device argument
is ambiguously valid as both a tag and a CPU number, it will be
interpreted as a tag.</p>
<p>Examples:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">maincpu</span></code></dt><dd><p>The device with the absolute tag <code class="docutils literal notranslate"><span class="pre">:maincpu</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">^melodypsg</span></code></dt><dd><p>The sibling device of the visible CPU with the tag <code class="docutils literal notranslate"><span class="pre">melodypsg</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">.:adc</span></code></dt><dd><p>The child device of the visible CPU with the tag <code class="docutils literal notranslate"><span class="pre">adc</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">2</span></code></dt><dd><p>The third CPU-like device in the system (zero-based index).</p>
</dd>
</dl>
<p>Commands that operate on memory extend this by allowing the device tag
or CPU number to be optionally followed by an address space identifier.
Address space identifiers are tag-like strings.  You can see them in
debugger memory viewer source lists.  If the address space identifier is
omitted, a default address space will be used.  Usually, this is the
address space that appears first for the device.  Many commands have
variants with <strong>d</strong>, <strong>i</strong> and <strong>o</strong> (data, I/O and opcodes) suffixes
that default to the address spaces at indices 1, 2 and 3, respectively,
as these have special significance for CPU-like devices.</p>
<p>In ambiguous cases, the default address space of a child device will be
used rather than a specific address space.</p>
<p>Examples:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">ram</span></code></dt><dd><p>The default address space of the device with the absolute tag
<code class="docutils literal notranslate"><span class="pre">:ram</span></code>, or the <code class="docutils literal notranslate"><span class="pre">ram</span></code> space of the visible CPU.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">.:io</span></code></dt><dd><p>The default address space of the child device of the visible CPU
with the tag <code class="docutils literal notranslate"><span class="pre">io</span></code>, or the <code class="docutils literal notranslate"><span class="pre">io</span></code> space of the visible CPU.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">:program</span></code></dt><dd><p>The default address space of the device with the absolute tag
<code class="docutils literal notranslate"><span class="pre">:program</span></code>, or the <code class="docutils literal notranslate"><span class="pre">program</span></code> space of the root machine device.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">^vdp</span></code></dt><dd><p>The default address space of the sibling device of the visible CPU
with the tag <code class="docutils literal notranslate"><span class="pre">vdp</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">^:data</span></code></dt><dd><p>The default address space of the sibling device of the visible CPU
with the tag <code class="docutils literal notranslate"><span class="pre">data</span></code>, or the <code class="docutils literal notranslate"><span class="pre">data</span></code> space of the parent device
of the visible CPU.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">1:rom</span></code></dt><dd><p>The default address space of the child device of the second CPU in
the system (zero-based index) with the tag <code class="docutils literal notranslate"><span class="pre">rom</span></code>, or the <code class="docutils literal notranslate"><span class="pre">rom</span></code>
space of the second CPU in the system.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">2</span></code></dt><dd><p>The default address space of the third CPU-like device in the system
(zero-based index).</p>
</dd>
</dl>
<p>If a command takes an emulated memory address as a parameter, the
address may optionally be followed by an address space specification, as
described above.</p>
<p>Examples:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">0220</span></code></dt><dd><p>Address 0220 in the default address space for the visible CPU.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">0378:io</span></code></dt><dd><p>Address 0378 in the default address space of the device with the
absolute tag <code class="docutils literal notranslate"><span class="pre">:io</span></code>, or the <code class="docutils literal notranslate"><span class="pre">io</span></code> space of the visible CPU.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">1234:.:rom</span></code></dt><dd><p>Address 1234 in the default address space of the child device of the
visible CPU with the tag <code class="docutils literal notranslate"><span class="pre">:rom</span></code>, or the <code class="docutils literal notranslate"><span class="pre">rom</span></code> space of the
visible CPU.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">1260:^vdp</span></code></dt><dd><p>Address 1260 in the default address space of the sibling device of
the visible CPU with the tag <code class="docutils literal notranslate"><span class="pre">vdp</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">8008:^:data</span></code></dt><dd><p>Address 8008 in the default address space of the sibling device of
the visible CPU with the tag <code class="docutils literal notranslate"><span class="pre">data</span></code>, or the <code class="docutils literal notranslate"><span class="pre">data</span></code> space of the
parent device of the visible CPU.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">9660::ram</span></code></dt><dd><p>Address 9660 in the default address space of the device with the
absolute tag <code class="docutils literal notranslate"><span class="pre">:ram</span></code>, or the <code class="docutils literal notranslate"><span class="pre">ram</span></code> space of the root machine
device.</p>
</dd>
</dl>
<p>The examples here include a lot of corner cases, but in general the
debugger should take the most likely meaning for a device or address
space specification.</p>
</section>
<section id="debugger-expression-syntax">
<span id="debugger-express"></span><h2><a class="toc-backref" href="#id4" role="doc-backlink">Debugger expression syntax</a><a class="headerlink" href="#debugger-expression-syntax" title="Link to this heading">¶</a></h2>
<p>Expressions can be used anywhere a numeric or Boolean parameter is
expected.  The syntax for expressions is similar to a subset of C-style
expression syntax, with full operator precedence and parentheses.  There
are a few operators missing (notably the ternary conditional operator),
and a few new ones (memory accessors).</p>
<p>The table below lists all the operators, ordered from highest to lowest
precedence:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">(</span></code> <code class="docutils literal notranslate"><span class="pre">)</span></code></dt><dd><p>Standard parentheses</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">++</span></code> <code class="docutils literal notranslate"><span class="pre">--</span></code></dt><dd><p>Postfix increment/decrement</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">++</span></code> <code class="docutils literal notranslate"><span class="pre">--</span></code> <code class="docutils literal notranslate"><span class="pre">~</span></code> <code class="docutils literal notranslate"><span class="pre">!</span></code> <code class="docutils literal notranslate"><span class="pre">-</span></code> <code class="docutils literal notranslate"><span class="pre">+</span></code> <code class="docutils literal notranslate"><span class="pre">b&#64;</span></code> <code class="docutils literal notranslate"><span class="pre">w&#64;</span></code> <code class="docutils literal notranslate"><span class="pre">d&#64;</span></code> <code class="docutils literal notranslate"><span class="pre">q&#64;</span></code> <code class="docutils literal notranslate"><span class="pre">b!</span></code> <code class="docutils literal notranslate"><span class="pre">w!</span></code> <code class="docutils literal notranslate"><span class="pre">d!</span></code> <code class="docutils literal notranslate"><span class="pre">q!</span></code></dt><dd><p>Prefix increment/decrement, binary complement, logical complement,
unary identity/negation, memory access</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">*</span></code> <code class="docutils literal notranslate"><span class="pre">/</span></code> <code class="docutils literal notranslate"><span class="pre">%</span></code></dt><dd><p>Multiplication, division, modulo</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">+</span></code> <code class="docutils literal notranslate"><span class="pre">-</span></code></dt><dd><p>Addition, subtraction</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code></dt><dd><p>Bitwise left/right shift</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&lt;</span></code> <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code> <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code></dt><dd><p>Less than, less than or equal, greater than, greater than or equal</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">==</span></code> <code class="docutils literal notranslate"><span class="pre">!=</span></code></dt><dd><p>Equal, not equal</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&amp;</span></code></dt><dd><p>Bitwise intersection (and)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">^</span></code></dt><dd><p>Bitwise exclusive or</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">|</span></code></dt><dd><p>Bitwise union (or)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code></dt><dd><p>Logical conjunction (and)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">||</span></code></dt><dd><p>Logical disjunction (or)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">=</span></code> <code class="docutils literal notranslate"><span class="pre">*=</span></code> <code class="docutils literal notranslate"><span class="pre">/=</span></code> <code class="docutils literal notranslate"><span class="pre">%=</span></code> <code class="docutils literal notranslate"><span class="pre">+=</span></code> <code class="docutils literal notranslate"><span class="pre">-=</span></code> <code class="docutils literal notranslate"><span class="pre">&lt;&lt;=</span></code> <code class="docutils literal notranslate"><span class="pre">&gt;&gt;=</span></code> <code class="docutils literal notranslate"><span class="pre">&amp;=</span></code> <code class="docutils literal notranslate"><span class="pre">|=</span></code> <code class="docutils literal notranslate"><span class="pre">^=</span></code></dt><dd><p>Assignment and modifying assignment</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">,</span></code></dt><dd><p>Separate terms, function parameters</p>
</dd>
</dl>
<p>Major differences from C expression semantics:</p>
<ul class="simple">
<li><p>All numbers are unsigned 64-bit values.  In particular, this means
negative numbers are not possible.</p></li>
<li><p>The logical conjunction and disjunction operators <code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> and <code class="docutils literal notranslate"><span class="pre">||</span></code> do
not have short-circuit properties – both sides of the expression are
always evaluated.</p></li>
</ul>
<section id="numbers">
<span id="debugger-express-num"></span><h3><a class="toc-backref" href="#id5" role="doc-backlink">Numbers</a><a class="headerlink" href="#numbers" title="Link to this heading">¶</a></h3>
<p>Literal numbers are prefixed according to their bases:</p>
<ul class="simple">
<li><p>Hexadecimal (base-16) with <code class="docutils literal notranslate"><span class="pre">$</span></code> or <code class="docutils literal notranslate"><span class="pre">0x</span></code></p></li>
<li><p>Decimal (base-10) with <code class="docutils literal notranslate"><span class="pre">#</span></code></p></li>
<li><p>Octal (base-8) with <code class="docutils literal notranslate"><span class="pre">0o</span></code></p></li>
<li><p>Binary (base-2) with <code class="docutils literal notranslate"><span class="pre">0b</span></code></p></li>
<li><p>Unprefixed numbers are hexadecimal (base-16).</p></li>
</ul>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">123</span></code> is 123 hexadecimal (291 decimal)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$123</span></code> is 123 hexadecimal (291 decimal)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0x123</span></code> is 123 hexadecimal (291 decimal)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#123</span></code> is 123 decimal</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0o123</span></code> is 123 octal (83 decimal)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0b1001</span></code> is 1001 binary (9 decimal)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0b123</span></code> is invalid</p></li>
</ul>
</section>
<section id="boolean-values">
<span id="debugger-express-bool"></span><h3><a class="toc-backref" href="#id6" role="doc-backlink">Boolean values</a><a class="headerlink" href="#boolean-values" title="Link to this heading">¶</a></h3>
<p>Any expression that evaluates to a number can be used where a Boolean
value is required.  Zero is treated as false, and all non-zero values
are treated as true.  Additionally, the string <code class="docutils literal notranslate"><span class="pre">true</span></code> is treated as
true, and the string <code class="docutils literal notranslate"><span class="pre">false</span></code> is treated as false.</p>
<p>An empty string may be supplied as an argument for Boolean parameters to
debugger commands to use the default value, even when subsequent
parameters are specified.</p>
</section>
<section id="memory-accesses">
<span id="debugger-express-mem"></span><h3><a class="toc-backref" href="#id7" role="doc-backlink">Memory accesses</a><a class="headerlink" href="#memory-accesses" title="Link to this heading">¶</a></h3>
<p>The memory access prefix operators allow reading from and writing to
emulated address spaces.  The memory prefix operators specify the
access size and whether side effects are disabled, and may optionally be
preceded by an address space specification.  The supported access sizes
and side effect modes are as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> specifies an 8-bit access (byte)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">w</span></code> specifies a 16-bit access (word)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> specifies a 32-bit access (double word)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">q</span></code> specifies a 64-bit access (quadruple word)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;</span></code> suppress side effects</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">!</span></code> do not suppress side effects</p></li>
</ul>
<p>Suppressing side effects of a read access yields the value reading from
address would, with no further effects.  For example reading a mailbox
with side effects disabled will not clear the pending flag, and reading
a FIFO with side effects disabled will not remove an item.</p>
<p>For write accesses, suppressing side effects doesn’t change behaviour in
most cases – you want to see the effects of writing to a location.
However, there are some exceptions where it is useful to separate
multiple effects of a write access.  For example:</p>
<ul class="simple">
<li><p>Some registers need to be written in sequence to avoid race
conditions.  The debugger can issue multiple writes at the same point
in emulated time, so these race conditions can be avoided trivially.
For example writing to the MC68HC05 output compare register high byte
(OCRH) inhibits compare until the output compare register low byte
(OCRL) is written to prevent race conditions.  Since the debugger can
write to both locations at the same instant from the emulated
machine’s point of view, the race condition is not usually relevant.
It’s more error-prone if you can accidentally set hidden state when
all you really want to do is change the value, so writing to OCRH with
side effects suppressed does not inhibit compare, it just changes the
value in the output compare register.</p></li>
<li><p>Writing to some registers has multiple effects that may be useful to
separate for debugging purposes.  Using the MC68HC05 as an example
again, writing to OCRL changes the value in the output compare
register, and also clears the output compare flag (OCF) and enables
compare if it was previously inhibited by writing to OCRH.  Writing to
OCRL with side effects disabled just changes the value in the register
without clearing OCF or enabling compare, since it’s useful for
debugging purposes.  Writing to OCRL with side effects enabled has the
additional effects.</p></li>
</ul>
<p>The size may optionally be preceded by an access type specification:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> or <code class="docutils literal notranslate"><span class="pre">lp</span></code> specifies a logical address defaulting to space 0
(program)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> or <code class="docutils literal notranslate"><span class="pre">ld</span></code> specifies a logical address defaulting to space 1
(data)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> or <code class="docutils literal notranslate"><span class="pre">li</span></code> specifies a logical address defaulting to space 2
(I/O)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> or <code class="docutils literal notranslate"><span class="pre">l3</span></code> specifies a logical address defaulting to space 3
(opcodes)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pp</span></code> specifies a physical address defaulting to space 0 (program)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pd</span></code> specifies a physical address defaulting to space 1 (data)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pi</span></code> specifies a physical address defaulting to space 2 (I/O)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p3</span></code> specifies a physical address defaulting to space 3 (opcodes)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code> specifies direct read/write pointer access defaulting to space 0
(program)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">o</span></code> specifies direct read/write pointer access defaulting to space 3
(opcodes)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> specifies a memory region</p></li>
</ul>
<p>Finally, this may be preceded by a tag and/or address space name
followed by a dot (<code class="docutils literal notranslate"><span class="pre">.</span></code>).</p>
<p>That may seem like a lot to digest, so let’s look at the simplest
examples:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">b&#64;&lt;addr&gt;</span></code></dt><dd><p>Refers to the byte at <strong>&lt;addr&gt;</strong> in the program space of the current
CPU while suppressing side effects</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">b!&lt;addr&gt;</span></code></dt><dd><p>Refers to the byte at <strong>&lt;addr&gt;</strong> in the program space of the current
CPU, <em>not</em> suppressing side effects such as reading a mailbox
clearing the pending flag, or reading a FIFO removing an item</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">w&#64;&lt;addr&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">w!&lt;addr&gt;</span></code></dt><dd><p>Refer to the word at <strong>&lt;addr&gt;</strong> in the program space of the current
CPU, suppressing or not suppressing side effects, respectively.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">d&#64;&lt;addr&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">d!&lt;addr&gt;</span></code></dt><dd><p>Refer to the double word at <strong>&lt;addr&gt;</strong> in the program space of the
current CPU, suppressing or not suppressing side effects,
respectively.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">q&#64;&lt;addr&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">q!&lt;addr&gt;</span></code></dt><dd><p>Refer to the quadruple word at <strong>&lt;addr&gt;</strong> in the program space of
the current CPU, suppressing or not suppressing side effects,
respectively.</p>
</dd>
</dl>
<p>Adding access types gives additional possibilities:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">dw&#64;300</span></code></dt><dd><p>Refers to the word at 300 in the data space of the current CPU while
suppressing side effects</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">id&#64;400</span></code></dt><dd><p>Refers to the double word at 400 in the I/O space of the current CPU
while suppressing side effects</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ppd!&lt;addr&gt;</span></code></dt><dd><p>Refers to the double word at physical address <strong>&lt;addr&gt;</strong> in the
program space of the current CPU while not suppressing side effects</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">rw&#64;&lt;addr&gt;</span></code></dt><dd><p>Refers to the word at address <strong>&lt;addr&gt;</strong> in the program space of the
current CPU using direct read/write pointer access</p>
</dd>
</dl>
<p>If we want to access an address space of a device other than the current
CPU, an address space beyond the first four indices, or a memory region,
we need to include a tag or name:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">ramport.b&#64;&lt;addr&gt;</span></code></dt><dd><p>Refers to the byte at address <strong>&lt;addr&gt;</strong> in the <code class="docutils literal notranslate"><span class="pre">ramport</span></code> space of
the current CPU</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">audiocpu.dw&#64;&lt;addr&gt;</span></code></dt><dd><p>Refers to the word at address <strong>&lt;addr&gt;</strong> in the data space of the
CPU with absolute tag <code class="docutils literal notranslate"><span class="pre">:audiocpu</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">maincpu:status.b&#64;&lt;addr&gt;</span></code></dt><dd><p>Refers to the byte at address <strong>&lt;addr&gt;</strong> in the <code class="docutils literal notranslate"><span class="pre">status</span></code> space of
the CPU with the absolute tag <code class="docutils literal notranslate"><span class="pre">:maincpu</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">monitor.mb&#64;78</span></code></dt><dd><p>Refers to the byte at 78 in the memory region with the absolute tag
<code class="docutils literal notranslate"><span class="pre">:monitor</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">..md&#64;202</span></code></dt><dd><p>Refers to the double word at address 202 in the memory region with
the same tag path as the current CPU.</p>
</dd>
</dl>
<p>Some combinations are not useful.  For example physical and logical
addresses are equivalent for some CPUs, and direct read/write pointer
accesses never have side effects.  Accessing a memory region (<code class="docutils literal notranslate"><span class="pre">m</span></code>
access type) requires a tag to be specified.</p>
<p>Memory accesses can be used as both lvalues and rvalues, so you can write
<code class="docutils literal notranslate"><span class="pre">b&#64;100</span> <span class="pre">=</span> <span class="pre">ff</span></code> to store a byte in memory.</p>
</section>
<section id="functions">
<span id="debugger-express-func"></span><h3><a class="toc-backref" href="#id8" role="doc-backlink">Functions</a><a class="headerlink" href="#functions" title="Link to this heading">¶</a></h3>
<p>The debugger supports a number of useful utility functions in expressions.</p>
<dl class="simple">
<dt>min(&lt;a&gt;, &lt;b&gt;)</dt><dd><p>Returns the lesser of the two arguments.</p>
</dd>
<dt>max(&lt;a&gt;, &lt;b&gt;)</dt><dd><p>Returns the greater of the two arguments.</p>
</dd>
<dt>if(&lt;cond&gt;, &lt;trueval&gt;, &lt;falseval&gt;)</dt><dd><p>Returns <strong>&lt;trueval&gt;</strong> if <strong>&lt;cond&gt;</strong> is true (non-zero), or
<strong>&lt;falseval&gt;</strong> otherwise.  Note that the expressions for
<strong>&lt;trueval&gt;</strong> and <strong>&lt;falseval&gt;</strong> are both evaluated irrespective of
whether <strong>&lt;cond&gt;</strong> is true or false.</p>
</dd>
<dt>abs(&lt;x&gt;)</dt><dd><p>Reinterprets the argument as a 64-bit signed integer and returns the
absolute value.</p>
</dd>
<dt>bit(&lt;x&gt;, &lt;n&gt;[, &lt;w&gt;])</dt><dd><p>Extracts and right-aligns a bit field <strong>&lt;w&gt;</strong> bits wide from <strong>&lt;x&gt;</strong>
with least significant bit position <strong>&lt;n&gt;</strong>, counting from the
least significant bit.  If <strong>&lt;w&gt;</strong> is omitted, a single bit is
extracted.</p>
</dd>
<dt>s8(&lt;x&gt;)</dt><dd><p>Sign-extends the argument from 8 bits to 64 bits (overwrites bits 8
through 63, inclusive, with the value of bit 7, counting from the
least significant bit).</p>
</dd>
<dt>s16(&lt;x&gt;)</dt><dd><p>Sign-extends the argument from 16 bits to 64 bits (overwrites bits
16 through 63, inclusive, with the value of bit 15, counting from
the least significant bit).</p>
</dd>
<dt>s32(&lt;x&gt;)</dt><dd><p>Sign-extends the argument from 32 bits to 64 bits (overwrites bits
32 through 63, inclusive, with the value of bit 31, counting from
the least significant bit).</p>
</dd>
</dl>
</section>
</section>
<section id="source-level-debugging">
<span id="srcdbg"></span><h2><a class="toc-backref" href="#id9" role="doc-backlink">Source-level debugging</a><a class="headerlink" href="#source-level-debugging" title="Link to this heading">¶</a></h2>
<p>Source-level debugging allows you to step through and reference symbols
from the original source of a program, rather than the disassembly.
This feature is intended for use
when emulating a vintage microcomputer and running software on that
emulated machine for which you have access to the original source code.
For example, if you are developing new software for a vintage machine,
source-level debugging allows you to view your own source code while
debugging.</p>
<section id="enabling-source-level-debugging">
<span id="srcdbg-enable"></span><h3><a class="toc-backref" href="#id10" role="doc-backlink">Enabling source-level debugging</a><a class="headerlink" href="#enabling-source-level-debugging" title="Link to this heading">¶</a></h3>
<p>You will need to generate a <a class="reference internal" href="#srcdbg-mdi"><span class="std std-ref">MAME Debugging Information File</span></a>.
You can then enable source-level debugging by launching MAME with
the <a class="reference internal" href="../commandline/commandline-all.html#mame-commandline-srcdbginfo"><span class="std std-ref">-src_debug_info</span></a>
command-line option.  You may also want
to specify <a class="reference internal" href="../commandline/commandline-all.html#mame-commandline-srcdbgsearchpath"><span class="std std-ref">-src_debug_search_path</span></a>
and / or <a class="reference internal" href="../commandline/commandline-all.html#mame-commandline-srcdbgprefixmap"><span class="std std-ref">-src_debug_prefix_map</span></a>.</p>
<p>Once source-level debugging is enabled, you will then be able to
access the Options menu, Show Source command from
the main debugger window.  You may switch back and forth between source
and disassembly view, and open separate disassembly windows even
while the main window shows source.</p>
<p>The source view has a drop-list at the top for selecting which source
file to view.  The list is populated with source file paths from the
<a class="reference internal" href="#srcdbg-mdi"><span class="std std-ref">MAME Debugging Information File</span></a>.  When the debugger is paused,
you can change the selection to view the file you wish.  When stepping,
the selection is automatically updated to show the file associated
with the current PC address.</p>
</section>
<section id="source-level-breakpoints">
<span id="srcdbg-bp"></span><h3><a class="toc-backref" href="#id11" role="doc-backlink">Source-level breakpoints</a><a class="headerlink" href="#source-level-breakpoints" title="Link to this heading">¶</a></h3>
<p>The expression evaluator includes syntax for specifying a source
file and line number.  This can be used in conjunction with the
<a class="reference internal" href="breakpoint.html#debugger-command-bpset"><span class="std std-ref">bpset</span></a> command to set
a breakpoint on a particular line number,
rather than specifying the address manually.  Source-level symbols
evaluate to addresses, and so may also be used in <code class="docutils literal notranslate"><span class="pre">bpset</span></code> commands.</p>
<p>When specifying a
source file, you may specify either the full path to the source file
as it existed on the machine that built the binary, the full path
to the source file as it exists on the host running MAME, or any
non-ambiguous substring at the end of the full path (such as
just the filename).  The filename or path is surrounded by single
backticks <code class="docutils literal notranslate"><span class="pre">`</span></code>, with the line number immediately following
the closing backtick.</p>
<p>Examples:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">bpset</span> <span class="pre">`c:\full\path\to\file.c`3</span></code></dt><dd><p>Set a breakpoint on the first instruction associated with file.c, line 3</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">bpset</span> <span class="pre">`file.c`3</span></code></dt><dd><p>Set a breakpoint on the first instruction associated with file.c, line 3.
Note the use of just the filename instead of a full path.  This is fine
so long as it is unambiguous relative to the other paths present in the
MAME Debugging Information File.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">print</span> <span class="pre">`to\file.c`3</span></code></dt><dd><p>Print the address of the first instruction associated with file.c, line 3.
Note the use of the path <em>ending</em> rather than the full path.  This is fine
so long as it is unambiguous.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">bpset</span> <span class="pre">Main</span></code></dt><dd><p>Set a breakpoint on the label named <code class="docutils literal notranslate"><span class="pre">Main</span></code></p>
</dd>
</dl>
<p>When the main window is showing source, you may also click on any source line
and hit F9 to set a breakpoint on that line.</p>
</section>
<section id="source-level-stepping">
<span id="srcdbg-stepping"></span><h3><a class="toc-backref" href="#id12" role="doc-backlink">Source-level stepping</a><a class="headerlink" href="#source-level-stepping" title="Link to this heading">¶</a></h3>
<p>The stepping commands <code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">over</span></code>, and <code class="docutils literal notranslate"><span class="pre">out</span></code> have source-level debugging
versions <a class="reference internal" href="execution.html#debugger-command-steps"><span class="std std-ref">steps</span></a>,
<a class="reference internal" href="execution.html#debugger-command-overs"><span class="std std-ref">overs</span></a>, and
<a class="reference internal" href="execution.html#debugger-command-outs"><span class="std std-ref">outs</span></a>, respectively, which operate
at the source level rather than at the disassembly level.
To take <code class="docutils literal notranslate"><span class="pre">step</span></code> as an example, if
the PC points to an address associated with line 4, <code class="docutils literal notranslate"><span class="pre">step</span></code> (with
no parameters) will advance
to the next instruction, whereas <code class="docutils literal notranslate"><span class="pre">steps</span></code> will advance to the next instruction
that is associated with a source line other than 4.  When the original
source is assembly language, <code class="docutils literal notranslate"><span class="pre">step</span></code> and <code class="docutils literal notranslate"><span class="pre">steps</span></code> generally behave the same.
But when the original source is in a higher-level language like C or BASIC, <code class="docutils literal notranslate"><span class="pre">steps</span></code>
executes the remainder of a block of instructions associated with
the current source line.</p>
<p>When executing Step Into, Step Over, and Step Out from the menu or keyboard
shortcuts, the behavior depends on what the main window is showing.
If the main window shows disassembly, then <code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">over</span></code>, or <code class="docutils literal notranslate"><span class="pre">out</span></code>
would be invoked.  If the main window shows source,
<code class="docutils literal notranslate"><span class="pre">steps</span></code>, <code class="docutils literal notranslate"><span class="pre">overs</span></code>, or <code class="docutils literal notranslate"><span class="pre">outs</span></code>  would be invoked.</p>
</section>
<section id="source-level-symbol-evaluation">
<span id="srcdbg-symbols"></span><h3><a class="toc-backref" href="#id13" role="doc-backlink">Source-level symbol evaluation</a><a class="headerlink" href="#source-level-symbol-evaluation" title="Link to this heading">¶</a></h3>
<p>MAME defines its own built-in symbols based on the current
CPU (e.g., register names) and from its global symbol table
(e.g., <code class="docutils literal notranslate"><span class="pre">beamx</span></code>, <code class="docutils literal notranslate"><span class="pre">frame</span></code>, names of built-in <a class="reference internal" href="#debugger-express-func"><span class="std std-ref">functions</span></a>, etc.).
When source-level debugging is enabled, symbols from the source code will
be imported from the MAME Debugging Information File and added
to the list of symbols recognized by MAME's expression evaluator.</p>
<p>A symbol from the MAME Debugging Information File representing a source-code
variable evaluates to the variable's <em>address</em>, not its <em>value</em>.  So,
for example, a 16-bit C compiler that compiles <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">harry</span> <span class="pre">=</span> <span class="pre">4;</span></code> will
create a symbol named <code class="docutils literal notranslate"><span class="pre">harry</span></code> whose value is the address at which
the variable is stored.  To view the <em>value</em> you would issue a command
to the debugger console such as <code class="docutils literal notranslate"><span class="pre">print</span> <span class="pre">w&#64;harry</span></code>.</p>
<ul>
<li><p><strong>Symbol collisions and priority</strong>: It is possible that source-level symbols
present in the MAME Debugging Information File will conflict with built-in symbols.
When source-level debugging is enabled, source-level symbols take precedence.  You
may always force a reference to the built-in symbol by prefixing the symbol with <code class="docutils literal notranslate"><span class="pre">ns\</span></code>
(&quot;not source&quot;).  For example, suppose the MAME Debugging Information File includes the
source-level symbol <code class="docutils literal notranslate"><span class="pre">y</span></code> which conflicts with the symbol for the register <code class="docutils literal notranslate"><span class="pre">y</span></code>.
References to <code class="docutils literal notranslate"><span class="pre">y</span></code> will be interpreted as the source-level symbol <code class="docutils literal notranslate"><span class="pre">y</span></code>.
References to <code class="docutils literal notranslate"><span class="pre">ns\y</span></code>, such as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">print</span> <span class="pre">ns\y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">print</span> <span class="pre">b&#64;ns\y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wpset</span> <span class="pre">ns\y</span></code></p></li>
</ul>
<p>will be interpeted as the register <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
</li>
<li><p><strong>Case sensitivity</strong>: When the debugger evaluates expressions, symbols
are generally interpreted case-insensitively when source-level debugging
is not active.  Many programming languages treat symbols
case-sensitively.  This can lead to source-level symbols like <code class="docutils literal notranslate"><span class="pre">Foo</span></code> and <code class="docutils literal notranslate"><span class="pre">foo</span></code>
being present in the MAME Debugging Information File simultaneously.
When source-level debugging is active and MAME's expression evaluator
encounters a symbol, it will give precendence to
a case-sensitive match.  If no such match is found, it will look for a
case-insensitive match.</p></li>
</ul>
</section>
<section id="address-offsets">
<span id="srcdbg-offsets"></span><h3><a class="toc-backref" href="#id14" role="doc-backlink">Address offsets</a><a class="headerlink" href="#address-offsets" title="Link to this heading">¶</a></h3>
<p>In some cases, the assembler or compiler does not know where the generated
code will be loaded at run-time.  For example, the program might be written
in position-independent code to allow an operating system to decide
where to load the code at run-time.  In such cases, the assembler or compiler
will be unable to provide the correct addresses in the MAME Debugging Information
File.  A build tool that supports run-time relocation could then start numbering
its addresses at 0, assuming that the operating system will apply the appropriate
offset when the binary is loaded.  Similarly, the MAME debugger may also
apply an offset to the addresses from the debugging info so that the
resulting addresses match where the code is loaded at run-time.  You can do this
in two ways:</p>
<ul class="simple">
<li><p>On the command-line, specify <a class="reference internal" href="../commandline/commandline-all.html#mame-commandline-srcdbgoffset"><span class="std std-ref">-src_debug_offset</span></a>
with the offset to apply.
This approach makes sense if the code to be debugged is reliably loaded
at an offset you can predict.</p></li>
<li><p>At any time during the debugging of the program, use the command <a class="reference internal" href="general.html#debugger-command-sdoffset"><span class="std std-ref">sdoffset</span></a>
from the debugger console with the offset to apply.  This approach can be used by
users or LUA scripts that need to inspect memory to determine where the program was
loaded.  Any breakpoints set before <code class="docutils literal notranslate"><span class="pre">sdoffset</span></code> was executed will need to be removed
and re-added so the new offset can be applied.  Any source-level symbols loaded
from the MAME Debugging Information File will automatically evaluate to
values with the new offset the next time a command references them.</p></li>
</ul>
</section>
<section id="generating-mame-debugging-information-files">
<span id="srcdbg-mdi"></span><h3><a class="toc-backref" href="#id15" role="doc-backlink">Generating MAME Debugging Information Files</a><a class="headerlink" href="#generating-mame-debugging-information-files" title="Link to this heading">¶</a></h3>
<p>MAME Debugging Information Files (or <code class="docutils literal notranslate"><span class="pre">.mdi</span></code> files) are generated by
assemblers or compilers that target machines emulated by MAME.  Currently
<code class="docutils literal notranslate"><span class="pre">.mdi</span></code> files adhere to a single binary format called &quot;Simple&quot;.  In the
future, new formats may be created as the need arises.  The Simple format includes:</p>
<ul>
<li><p>Full or relative paths to the source files input to the build tool</p></li>
<li><p>Mappings from source file and line numbers to blocks of 16-bit addresses where the
corresponding instructions reside</p></li>
<li><p>Mappings from symbol names to 16-bit addresses</p>
<blockquote>
<div><ul class="simple">
<li><p>These symbols can either be global or scoped</p></li>
<li><p>Scoped symbols can either have fixed values or values
dependent on register values (e.g., stack local variables)</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>The recommended way for build tools to generate <code class="docutils literal notranslate"><span class="pre">.mdi</span></code> files is to use
the small static library <code class="docutils literal notranslate"><span class="pre">libmame_srcdbg_static.a</span></code>.  The source code resides
in the MAME tree at <code class="docutils literal notranslate"><span class="pre">src/lib/srcdbg</span></code>, and the library gets built to
a configuration-specific subdirectory, such as
<code class="docutils literal notranslate"><span class="pre">build/linux_gcc/bin/x64/Release/libmame_srcdbg_static.a</span></code>.  The header
file <code class="docutils literal notranslate"><span class="pre">srcdbg_api.h</span></code> includes declarations and documentation for the C
functions comprising the API, along with comments that describe how to use
them.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p><strong>Tools must not rely on any functionality
other than that declared in</strong> <code class="docutils literal notranslate"><span class="pre">srcdbg_api.h</span></code>
<strong>and</strong> <code class="docutils literal notranslate"><span class="pre">srcdbg_format.h</span></code>. <strong>Other files will
change without warning.</strong></p>
</div>
<p>Tools written in <strong>C++</strong> can include  <code class="docutils literal notranslate"><span class="pre">srcdbg_api.h</span></code> and link to
<code class="docutils literal notranslate"><span class="pre">libmame_srcdbg_static.a</span></code> without any further makefile changes.  Since
the library's API is pure C, tools
written in <strong>C</strong> can also include <code class="docutils literal notranslate"><span class="pre">srcdbg_api.h</span></code> and link to
<code class="docutils literal notranslate"><span class="pre">libmame_srcdbg_static.a</span></code>, but will need to add the C++ standard library
to the link line (as the library's <em>implementation</em> is C++).  For example,
<code class="docutils literal notranslate"><span class="pre">cc</span> <span class="pre">-m64</span> <span class="pre">-o</span> <span class="pre">mytool</span> <span class="pre">mytool.c</span> <span class="pre">-L/path/to/lib/dir</span> <span class="pre">-lmame_srcdbg_static</span> <span class="pre">-lstdc++</span></code>.
Note that <code class="docutils literal notranslate"><span class="pre">-lstdc++</span></code> must appear at the <em>end</em>.</p>
<p>Tools <em>not</em> written in C or C++ may be able to use the shared library
<code class="docutils literal notranslate"><span class="pre">libmame_srcdbg_shared.so</span></code> or <code class="docutils literal notranslate"><span class="pre">mame_srcdbg_shared.dll</span></code>, assuming the tool
is written in a language that supports interfacing with shared libraries.</p>
<div class="admonition-linux-shared-library-versioning admonition">
<p class="admonition-title">Linux shared library versioning</p>
<p>On Linux the shared library follows the recommended versioning names, with
the initial version of the library's <em>real name</em> being
<code class="docutils literal notranslate"><span class="pre">libmame_srcdbg_shared.so.1.0</span></code> and <em>soname</em> being <code class="docutils literal notranslate"><span class="pre">libmame_srcdbg_shared.so.1</span></code>.
MAME does not have a setup program, so the responsibility is on tools
redistributing the shared library to perform the usual shared library installation
steps.  For example, a tool might want to insulate itself from the machine's
environment, and tuck its own copy of the shared library into a tool-specific
folder, and use the <code class="docutils literal notranslate"><span class="pre">-rpath</span></code> linker option to declare where the tool can
find <code class="docutils literal notranslate"><span class="pre">libmame_srcdbg_shared.so</span></code> at run-time.  Alternatively, a tool could
install <code class="docutils literal notranslate"><span class="pre">libmame_srcdbg_shared.so</span></code> into a machine-wide folder like
<code class="docutils literal notranslate"><span class="pre">/usr/lib</span></code> and run <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">ldconfig</span></code> to register the library and create
a symbolic link from the soname to the real name.  In any case, the tool
will need to manually create a symbolic link from the <em>linker name</em>
<code class="docutils literal notranslate"><span class="pre">libmame_srcdbg_shared.so</span></code> to either the soname
(if <code class="docutils literal notranslate"><span class="pre">ldconfig</span></code> was run) or directly to the real
name to ensure that the build-time linker can find <code class="docutils literal notranslate"><span class="pre">libmame_srcdbg_shared.so</span></code>.
Before proceeding with any of these options, it's recommended that you read up
on Linux shared library versioning, for example:
<a class="reference external" href="https://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html">https://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html</a></p>
</div>
<p>If consuming neither the static nor shared version of the MAME srcdbg library is
feasible, tools may also manually generate the binary format directly.  The format
is defined in <code class="docutils literal notranslate"><span class="pre">src/lib/srcdbg/srcdbg_format.h</span></code>.  Because this is error-prone,
tools should prefer using the static or shared library over generating the binary
format directly.</p>
</section>
<section id="viewing-mame-debugging-information-files-with-srcdbgdump">
<span id="srcdbg-dump"></span><h3><a class="toc-backref" href="#id16" role="doc-backlink">Viewing MAME Debugging Information Files with srcdbgdump</a><a class="headerlink" href="#viewing-mame-debugging-information-files-with-srcdbgdump" title="Link to this heading">¶</a></h3>
<p>A small console executable, <a class="reference internal" href="../tools/othertools.html#othertools-srcdbgdump"><span class="std std-ref">srcdbgdump</span></a> is built
along with other MAME tools.  It may be used to view the contents
of MAME Debugging Information files.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../advanced/linux-lightguns.html" class="btn btn-neutral float-left" title="Linux Lightguns" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="general.html" class="btn btn-neutral float-right" title="General Debugger Commands" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1997-2025, MAMEdev and contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>